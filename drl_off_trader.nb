(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    171082,       3819]
NotebookOptionsPosition[    170178,       3799]
NotebookOutlinePosition[    170544,       3815]
CellTagsIndexPosition[    170501,       3812]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.821932183614291*^9, 3.821932191628768*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"570945a0-ea7e-4a61-879c-11b5e893f556"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Read", " ", "the", " ", "CSV", " ", "file", " ", "with", " ", "the", " ", 
    "prices", " ", "and", " ", 
    RowBox[{"volumes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", "\"\<ADA-USDT.csv\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uprices", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"simlength", "=", 
     RowBox[{"Length", "[", "uprices", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uvolumes", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "6"}], "]"}], "]"}], "/", "10000000"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "2", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Pass", " ", "the", " ", "prices", " ", "through", " ", "a", " ", "filer",
      " ", "and", " ", "make", " ", "a", " ", "list", " ", "of", " ", "the", 
     " ", "new", " ", "prices", " ", "and", " ", "preceding", " ", 
     RowBox[{"volumes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prices", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "simlength"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"volumes", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "simlength"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pinit", "=", 
     RowBox[{"uprices", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prices", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"uprices", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"volumes", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"uvolumes", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"i", "\[LessEqual]", "simlength"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"uprices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "pinit"}], "]"}], "/", 
           "pinit"}], ">", "0.01"}], ",", 
         RowBox[{
          RowBox[{"pinit", "=", 
           RowBox[{"uprices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"prices", "[", 
            RowBox[{"[", "l", "]"}], "]"}], "=", 
           RowBox[{"uprices", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"volumes", "[", 
            RowBox[{"[", "l", "]"}], "]"}], "=", 
           RowBox[{"uvolumes", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ";", 
          RowBox[{"l", "=", 
           RowBox[{"l", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{"i", "+", "1"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prices", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"prices", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"simlength", "=", 
    RowBox[{"Length", "[", "prices", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"volumes", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"volumes", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Plot", " ", "the", " ", "prices", " ", "and", " ", 
     RowBox[{"volumes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"prices", ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"volumes", ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.82195469389394*^9, 3.8219547108267508`*^9}, {
   3.8220262129790697`*^9, 3.822026214349061*^9}, 3.8220263065972958`*^9, {
   3.8220427239252524`*^9, 3.8220427245099382`*^9}, {3.82210058828881*^9, 
   3.8221005930300355`*^9}, {3.8222135821777215`*^9, 3.822213582340576*^9}, {
   3.822498104473567*^9, 3.8224981045575275`*^9}, {3.822545444561183*^9, 
   3.8225454447869005`*^9}, {3.822795788447116*^9, 3.822795788720293*^9}, {
   3.823148381216735*^9, 3.823148391237422*^9}, {3.823148487347966*^9, 
   3.823148493126381*^9}, {3.823148727642333*^9, 3.823148749510779*^9}, {
   3.8231501057611713`*^9, 3.823150106049311*^9}, {3.8231528326915216`*^9, 
   3.823152833899365*^9}, {3.8231534552149496`*^9, 3.823153455317955*^9}, {
   3.823239774901744*^9, 3.823239775080042*^9}, {3.8233403366812854`*^9, 
   3.823340360311135*^9}, {3.8234006204372997`*^9, 3.823400624703866*^9}, {
   3.8240046386229615`*^9, 3.8240046389393063`*^9}, {3.824011996537862*^9, 
   3.8240120384179163`*^9}, {3.824030381098463*^9, 3.8240303881909447`*^9}, {
   3.824267889998996*^9, 3.824267943503972*^9}, {3.824267982903509*^9, 
   3.8242679850620127`*^9}, {3.8254886615544715`*^9, 3.82548866167723*^9}, {
   3.825666710369166*^9, 3.82566672432953*^9}, {3.8271124657032733`*^9, 
   3.827112466727831*^9}, {3.827199785986655*^9, 3.8271997880602283`*^9}, {
   3.827402151652357*^9, 3.827402153039152*^9}, {3.827586521062043*^9, 
   3.827586522653804*^9}, 3.8275865754317966`*^9, {3.827586615030603*^9, 
   3.8275866482732406`*^9}, 3.8275867194266496`*^9, {3.8275867582748723`*^9, 
   3.8275867954680276`*^9}, {3.827586855455204*^9, 3.827586902090842*^9}, {
   3.827586954286106*^9, 3.8275869718146205`*^9}, {3.8275870026379375`*^9, 
   3.8275870029807253`*^9}, {3.8275870372206945`*^9, 
   3.8275870452301545`*^9}, {3.8275871012876873`*^9, 
   3.8275871773964386`*^9}, {3.827587219656451*^9, 3.8275872583956366`*^9}, {
   3.8275873067610073`*^9, 3.8275873156376333`*^9}, {3.8275873468188334`*^9, 
   3.8275873469577627`*^9}, {3.8275873774484973`*^9, 3.827587379677746*^9}, {
   3.8275874266607666`*^9, 3.8275874375079775`*^9}, 3.82758747784023*^9, {
   3.827587590101804*^9, 3.8275875904647174`*^9}, {3.827587698015524*^9, 
   3.8275876987014217`*^9}, {3.830437080180523*^9, 3.830437095894306*^9}, {
   3.830437545312128*^9, 3.8304375473493137`*^9}, {3.830445943253539*^9, 
   3.830445943932108*^9}, 3.830941853883501*^9, {3.8309422280152392`*^9, 
   3.8309422286174746`*^9}, {3.8312619588440733`*^9, 
   3.8312620302983294`*^9}, {3.8312620817407923`*^9, 3.831262087216417*^9}, {
   3.831262135592081*^9, 3.831262138249982*^9}, {3.8376766412729225`*^9, 
   3.837676701700508*^9}, {3.83767691317254*^9, 3.83767694111699*^9}, {
   3.8415422128734446`*^9, 3.841542213591033*^9}, {3.8415424177750235`*^9, 
   3.8415424406271763`*^9}, {3.8415426220216427`*^9, 3.841542624957944*^9}, {
   3.841555671125696*^9, 3.841555675543524*^9}, 3.8421660265066175`*^9, {
   3.84217382932344*^9, 3.842173837183442*^9}, {3.842174003130597*^9, 
   3.8421740095877028`*^9}, {3.8421758318123465`*^9, 3.842175839249014*^9}, {
   3.842255358010247*^9, 3.8422553681407623`*^9}, {3.842255659405826*^9, 
   3.8422556709195614`*^9}, {3.842320680859169*^9, 3.84232068783523*^9}, {
   3.8423207655630484`*^9, 3.842320767976155*^9}, {3.842320811721908*^9, 
   3.8423208197601705`*^9}, {3.845542254589214*^9, 3.8455422721376796`*^9}, {
   3.845542316764391*^9, 3.8455423351111193`*^9}, 3.848041010378331*^9, 
   3.8696295331567774`*^9, 3.8727336793318243`*^9, {3.885973917494171*^9, 
   3.885973928691324*^9}, {3.8859740026887207`*^9, 3.8859740054583483`*^9}, {
   3.8859741612314005`*^9, 3.8859742579687095`*^9}, {3.885974427768044*^9, 
   3.8859744317237787`*^9}, {3.886049823165946*^9, 3.8860499031401587`*^9}, 
   3.886154059464465*^9},ExpressionUUID->"66edc94e-14f7-4175-b218-\
233bbc062f0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Parameters", "."}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vsize", "=", "5"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Number", " ", "of", " ", "data", " ", "points", " ", "for", " ", "each",
       " ", 
      RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"fsize", "=", 
     RowBox[{
     "1", "+", "vsize", "+", "1", "+", "1", "+", "1", "+", "1", "+", "1", "+",
       "1", "+", "1", "+", "1", "+", "1", "+", "1", "+", "4", "+", "3", "+", 
      "2", "+", "1", "+", "1"}]}]}], 
   RowBox[{"(*", " ", 
    RowBox[{"Size", " ", "of", " ", "the", " ", "feature", " ", 
     RowBox[{"vector", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hlsize", "=", "50"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"Size", " ", "of", " ", "the", " ", "hidden", " ", 
     RowBox[{"layer", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gamma", "=", "0.05"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{"Discount", " ", 
     RowBox[{"factor", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"probeps", "=", "0.0001"}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "Probability", " ", "to", " ", "reset", " ", "the", " ", "value", " ", 
     "of", " ", 
     RowBox[{"epsilon", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mlimn", "=", "75."}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "lowest", " ", "possible", " ", "value", " ", "of", " ", 
     RowBox[{"mlim", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"runs", "=", "1000"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{"Number", " ", "of", " ", "test", " ", 
      RowBox[{"runs", "."}]}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8416356167070265`*^9, 3.8416356812824497`*^9}, {
   3.8416358885140796`*^9, 3.841635889848959*^9}, {3.841636069034122*^9, 
   3.841636095246211*^9}, {3.841652845678399*^9, 3.841652860778674*^9}, 
   3.841660286370931*^9, 3.841713775347064*^9, 3.8418390621512284`*^9, 
   3.8421659450524178`*^9, {3.8421660373783054`*^9, 3.8421660605268965`*^9}, {
   3.842166238051868*^9, 3.8421662795384254`*^9}, {3.842166439018375*^9, 
   3.8421664391310296`*^9}, {3.842167858973072*^9, 3.842167859147917*^9}, {
   3.8421718055715237`*^9, 3.8421718078228846`*^9}, {3.842175888716107*^9, 
   3.842175888979401*^9}, {3.8422527841778336`*^9, 3.842252832139101*^9}, {
   3.842252864282357*^9, 3.8422528688882813`*^9}, 3.8422555653800178`*^9, 
   3.8422558550862193`*^9, {3.8422565053144236`*^9, 3.842256505481354*^9}, {
   3.8422566476220646`*^9, 3.8422566480269384`*^9}, {3.8422570190402007`*^9, 
   3.8422571095363255`*^9}, {3.8422571437275867`*^9, 3.8422572163581495`*^9}, 
   3.8422572700753326`*^9, {3.8422573098295927`*^9, 3.8422573348214507`*^9}, 
   3.842317312731209*^9, 3.842317394116435*^9, {3.842318190404775*^9, 
   3.8423182155790744`*^9}, 3.842318343405575*^9, {3.8423184016588116`*^9, 
   3.842318403079389*^9}, {3.8423190068374*^9, 3.842319006960501*^9}, {
   3.842319047354083*^9, 3.8423190701812143`*^9}, 3.8423191821434765`*^9, 
   3.8423199663086076`*^9, {3.842320036064578*^9, 3.84232010829862*^9}, {
   3.8423203711419225`*^9, 3.842320441336624*^9}, {3.8423204857457633`*^9, 
   3.8423206574659166`*^9}, {3.842321088379197*^9, 3.8423211360467806`*^9}, {
   3.842321190315672*^9, 3.842321190474375*^9}, {3.842321339658204*^9, 
   3.842321340993947*^9}, {3.8423214696787987`*^9, 3.842321541371623*^9}, 
   3.8423255490283775`*^9, {3.8423255971623025`*^9, 3.8423255972560844`*^9}, {
   3.84232564986683*^9, 3.8423257255485587`*^9}, 3.8423257865338464`*^9, {
   3.8423258408382835`*^9, 3.8423258637233257`*^9}, {3.8423259130315304`*^9, 
   3.8423259846855726`*^9}, {3.8423260619984055`*^9, 
   3.8423261077944417`*^9}, {3.842326436439468*^9, 3.8423264375253625`*^9}, {
   3.842326520304706*^9, 3.8423265717909718`*^9}, {3.842327014836842*^9, 
   3.8423270286990805`*^9}, 3.842327856103072*^9, {3.842327952551104*^9, 
   3.8423279655620313`*^9}, 3.8423281442633686`*^9, {3.8423285852853184`*^9, 
   3.8423285854391584`*^9}, 3.8423286818187895`*^9, {3.842328851570728*^9, 
   3.8423288545941715`*^9}, {3.8423400114885798`*^9, 3.842340011616906*^9}, {
   3.842340158481169*^9, 3.842340158550318*^9}, {3.8423402576102524`*^9, 
   3.842340257794977*^9}, {3.8423409157441463`*^9, 3.842340930469943*^9}, {
   3.842341021858879*^9, 3.84234102429103*^9}, {3.8423413546580763`*^9, 
   3.842341356286808*^9}, {3.842341537803497*^9, 3.8423415379266834`*^9}, {
   3.842358747812617*^9, 3.8423587479794407`*^9}, {3.842362903607399*^9, 
   3.8423629037883325`*^9}, {3.842423337078941*^9, 3.842423337250435*^9}, {
   3.842425208648904*^9, 3.8424252110911493`*^9}, {3.8424261589992113`*^9, 
   3.8424261594426312`*^9}, {3.842598978186325*^9, 3.8425990225865993`*^9}, 
   3.84259952879762*^9, {3.8426003137491055`*^9, 3.842600313875946*^9}, {
   3.8432072310709705`*^9, 3.8432072312079782`*^9}, {3.8432073009951253`*^9, 
   3.8432073011128063`*^9}, {3.8432078167254505`*^9, 3.843207816857551*^9}, {
   3.8432243070378857`*^9, 3.8432243082890854`*^9}, 3.8432244733688583`*^9, 
   3.8432245628355026`*^9, {3.843225296479393*^9, 3.843225297994458*^9}, {
   3.843225353085988*^9, 3.8432253551061945`*^9}, 3.843225497433536*^9, 
   3.8432256162049966`*^9, {3.8432262269411526`*^9, 3.8432262270856895`*^9}, {
   3.8434835945653887`*^9, 3.843483595288207*^9}, {3.843484037201104*^9, 
   3.8434840383401775`*^9}, {3.843528933229005*^9, 3.843528945334403*^9}, {
   3.843530824766572*^9, 3.843530883549876*^9}, {3.8435309710731134`*^9, 
   3.8435309793226867`*^9}, {3.843531136162444*^9, 3.8435311392951016`*^9}, {
   3.8435324704726915`*^9, 3.8435324757804933`*^9}, {3.84353961000096*^9, 
   3.843539614092033*^9}, 3.843539674489269*^9, {3.843554332103016*^9, 
   3.843554345083624*^9}, {3.8435544345211163`*^9, 3.8435544391309595`*^9}, 
   3.8435555294370236`*^9, 3.8435589271973205`*^9, {3.843571716920499*^9, 
   3.8435717170156326`*^9}, {3.8435717500701504`*^9, 3.84357175023736*^9}, {
   3.8435717822776794`*^9, 3.843571791972182*^9}, 3.8435718882578692`*^9, {
   3.843571922760986*^9, 3.843571933790823*^9}, {3.843572085089701*^9, 
   3.843572104421929*^9}, 3.843572393718789*^9, {3.843573035693508*^9, 
   3.8435730496101713`*^9}, {3.8435737487691326`*^9, 3.8435737488810377`*^9}, 
   3.8435768194273467`*^9, 3.843606901292099*^9, 3.8436401326899033`*^9, {
   3.8437382798856754`*^9, 3.8437382814157467`*^9}, {3.8437385797259345`*^9, 
   3.843738674486046*^9}, {3.8437395725763545`*^9, 3.8437395859764867`*^9}, 
   3.8437397287005777`*^9, {3.84374093979725*^9, 3.8437409400075326`*^9}, 
   3.8437414239128838`*^9, {3.8437869369209166`*^9, 3.8437869427796144`*^9}, 
   3.8437926753901405`*^9, 3.843876822283966*^9, {3.8447782435394416`*^9, 
   3.844778258659177*^9}, {3.8447787005610304`*^9, 3.8447787006768837`*^9}, {
   3.8447799030341034`*^9, 3.844779903203511*^9}, {3.8448393342764482`*^9, 
   3.844839361366625*^9}, {3.8448396986465373`*^9, 3.844839698776615*^9}, {
   3.8449363900606723`*^9, 3.8449363901625137`*^9}, {3.844939655247116*^9, 
   3.8449396603187284`*^9}, {3.844939714531034*^9, 3.844939715217825*^9}, {
   3.8449397804545746`*^9, 3.844939834030344*^9}, {3.844941817012887*^9, 
   3.844941817144202*^9}, {3.845095601482416*^9, 3.845095601646612*^9}, {
   3.84509567989709*^9, 3.8450956800406036`*^9}, {3.8450959162409134`*^9, 
   3.845095917967802*^9}, {3.8450960990024996`*^9, 3.8450960991260166`*^9}, {
   3.8452970671806293`*^9, 3.845297069318038*^9}, {3.8452975732313266`*^9, 
   3.845297573353817*^9}, 3.845346196101242*^9, {3.8454390785527916`*^9, 
   3.8454390787871823`*^9}, {3.845439361937688*^9, 3.845439409935793*^9}, {
   3.845442350432352*^9, 3.845442350787033*^9}, {3.8454432551119905`*^9, 
   3.845443255406805*^9}, {3.845443383353036*^9, 3.8454433838083334`*^9}, 
   3.8454476837524223`*^9, {3.8455421722869086`*^9, 3.8455421726423407`*^9}, {
   3.8455432253849535`*^9, 3.845543226789953*^9}, {3.8455441617417336`*^9, 
   3.845544169601679*^9}, {3.8455446199598665`*^9, 3.845544620148567*^9}, 
   3.8455448948423758`*^9, 3.8455449961794434`*^9, {3.845545429276766*^9, 
   3.8455454332367043`*^9}, {3.845545486581274*^9, 3.8455455030992217`*^9}, {
   3.845614512400894*^9, 3.8456145129911222`*^9}, {3.845614568972955*^9, 
   3.8456145691662655`*^9}, {3.8456454652514954`*^9, 3.845645465667784*^9}, {
   3.845646876346081*^9, 3.845646876723008*^9}, {3.8456485667847595`*^9, 
   3.845648567131179*^9}, {3.8456493722251472`*^9, 3.8456493856907787`*^9}, {
   3.845650280441709*^9, 3.8456502822860384`*^9}, {3.8456540124403243`*^9, 
   3.8456540164641366`*^9}, {3.845654046758738*^9, 3.8456540474212275`*^9}, {
   3.846048049398962*^9, 3.8460480572447495`*^9}, {3.8460495372320433`*^9, 
   3.846049537384371*^9}, 3.8460499354168744`*^9, {3.8460502152044773`*^9, 
   3.846050215326342*^9}, {3.8460502986430407`*^9, 3.846050299110398*^9}, {
   3.846080531179823*^9, 3.8460805316019287`*^9}, {3.8460808658984365`*^9, 
   3.846080866567649*^9}, {3.846305472055663*^9, 3.846305473320299*^9}, {
   3.8463075226970806`*^9, 3.8463075231640577`*^9}, {3.8463075753611307`*^9, 
   3.8463075757534933`*^9}, {3.846308445476392*^9, 3.8463084460638995`*^9}, {
   3.8463145935634704`*^9, 3.846314594047368*^9}, 3.8463147548527017`*^9, {
   3.8463156384094954`*^9, 3.846315638462572*^9}, {3.8463156821827745`*^9, 
   3.84631568474255*^9}, {3.8463157542931027`*^9, 3.8463157548757677`*^9}, {
   3.8463162494826684`*^9, 3.8463162495875797`*^9}, {3.846316533606532*^9, 
   3.846316533998825*^9}, {3.846317775950698*^9, 3.846317776555982*^9}, {
   3.846318808687869*^9, 3.8463188088116016`*^9}, 3.8463188837980366`*^9, {
   3.846319084976522*^9, 3.846319085215886*^9}, {3.846382500912735*^9, 
   3.8463825012819786`*^9}, {3.8463826309885254`*^9, 
   3.8463826314738336`*^9}, {3.846471069339777*^9, 3.846471069775495*^9}, {
   3.8464713728442125`*^9, 3.8464713732908297`*^9}, {3.846934176705039*^9, 
   3.8469341769712315`*^9}, {3.8469351872607484`*^9, 
   3.8469351874962916`*^9}, {3.8470020082541046`*^9, 
   3.8470020087587585`*^9}, {3.8470021018490753`*^9, 
   3.8470021092154055`*^9}, {3.847002726789775*^9, 3.8470027271697607`*^9}, {
   3.8470032169652166`*^9, 3.8470032290034885`*^9}, {3.8470039098630505`*^9, 
   3.8470039101802063`*^9}, {3.8470040800215735`*^9, 3.847004080397602*^9}, {
   3.847010330791627*^9, 3.847010331088108*^9}, {3.847010485516301*^9, 
   3.8470104858274355`*^9}, {3.847078001852768*^9, 3.8470780028526635`*^9}, {
   3.8472540632980947`*^9, 3.8472540635643573`*^9}, {3.8472572218218355`*^9, 
   3.8472572221195927`*^9}, {3.8472866925592337`*^9, 3.847286693463706*^9}, {
   3.847777559497162*^9, 3.8477775600482473`*^9}, {3.8478657569491434`*^9, 
   3.847865757080428*^9}, {3.8478662201794996`*^9, 3.8478662204958076`*^9}, {
   3.847956519519026*^9, 3.847956520123102*^9}, {3.8479574198973284`*^9, 
   3.8479574200199127`*^9}, {3.8480298410246525`*^9, 3.8480298413222404`*^9}, 
   3.848030741289239*^9, 3.848031011582939*^9, {3.848031236351947*^9, 
   3.8480312424661674`*^9}, {3.848031413080905*^9, 3.8480314132244053`*^9}, {
   3.848039149575689*^9, 3.8480391498284883`*^9}, {3.848039353375832*^9, 
   3.8480393536078887`*^9}, {3.8480400467169137`*^9, 3.848040047101944*^9}, {
   3.848040449271457*^9, 3.848040450638796*^9}, {3.8480414313221493`*^9, 
   3.84804143164845*^9}, {3.848053437611638*^9, 3.848053437895862*^9}, {
   3.8480543564042034`*^9, 3.8480543565166187`*^9}, {3.848054536174113*^9, 
   3.848054538105558*^9}, {3.8480545962092743`*^9, 3.8480546220290976`*^9}, {
   3.8480547398346367`*^9, 3.848054740602253*^9}, {3.8480601631080074`*^9, 
   3.848060164461296*^9}, {3.8480605852721443`*^9, 3.848060585750088*^9}, {
   3.84806075317268*^9, 3.8480607532873836`*^9}, 3.8480631022555084`*^9, {
   3.848063649171376*^9, 3.8480636582911587`*^9}, {3.848063695905512*^9, 
   3.84806373407014*^9}, {3.8480637914832234`*^9, 3.848063792464513*^9}, 
   3.8480638363515635`*^9, {3.848064548212065*^9, 3.848064548324113*^9}, {
   3.8480652402776256`*^9, 3.8480652405941615`*^9}, {3.8481102322488575`*^9, 
   3.8481102325557027`*^9}, {3.8481108649491053`*^9, 
   3.8481108660524116`*^9}, {3.8481118660310698`*^9, 
   3.8481118663484488`*^9}, {3.8481160275150056`*^9, 
   3.8481160278412275`*^9}, {3.848120171174542*^9, 3.8481201715343685`*^9}, {
   3.848121063794588*^9, 3.8481210648804426`*^9}, {3.848121392890998*^9, 
   3.848121393472924*^9}, {3.8481214412982616`*^9, 3.8481214508156385`*^9}, {
   3.8483240600553656`*^9, 3.848324060224285*^9}, 3.8483888458527527`*^9, {
   3.8780060461618404`*^9, 3.87800604661349*^9}, {3.879907033699032*^9, 
   3.879907034976308*^9}, {3.884667167082757*^9, 3.884667170468443*^9}, {
   3.884667458156307*^9, 3.8846674593822145`*^9}, {3.8846682084847813`*^9, 
   3.8846682091708717`*^9}, 3.8859801304110885`*^9, {3.8859803958688984`*^9, 
   3.8859803959576464`*^9}, {3.8860499336971903`*^9, 3.886050008712026*^9}, {
   3.8860500628411264`*^9, 3.8860500667787657`*^9}, {3.8860500992591133`*^9, 
   3.886050139642994*^9}, {3.8860502148547306`*^9, 3.8860502784654703`*^9}, {
   3.8860503576130843`*^9, 
   3.886050372035372*^9}},ExpressionUUID->"e98b9b76-199a-4c9d-b3e2-\
0225b990dfc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"feat", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "fsize"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Feature", " ", 
    RowBox[{"vector", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pr", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "vsize"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"List", " ", "of", " ", "prices", " ", "in", " ", "the", " ", 
    RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Hidden", " ", "layer", " ", 
    RowBox[{"outputs", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hlayer1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "hlsize"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hlayer2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "hlsize"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Gradients", " ", "of", " ", "the", " ", "Q"}], "-", 
    RowBox[{"functions", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradq1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"hlsize", "+", "fsize"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradq1new", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"hlsize", "+", "fsize"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradq2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"hlsize", "+", "fsize"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradq2new", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"hlsize", "+", "fsize"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Q", "-", 
    RowBox[{"functions", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qarr1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "19"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qarr2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "19"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qarr", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "19"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qarr1new", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "19"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qarr2new", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "19"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Lists", " ", "to", " ", "write", " ", "sav", " ", "and", " ", "twth", " ",
     "at", " ", "the", " ", "end", " ", "of", " ", "each", " ", 
    RowBox[{"run", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"savarray", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "runs"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"twtharray", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "runs"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Relative", " ", "movements", " ", "of", " ", "the", " ", "price"}], ",", 
    " ", 
    RowBox[{"etc", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmd1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"vsize", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmd2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"vsize", "-", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmd3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"vsize", "-", "3"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmd4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"vsize", "-", "4"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8416354628312883`*^9, 3.8416354995705447`*^9}, 
   3.841635627432867*^9, {3.8416361069641094`*^9, 3.8416361071174617`*^9}, {
   3.841636163652996*^9, 3.841636166714157*^9}, 3.8417114409475074`*^9, {
   3.841712841811293*^9, 3.8417129390691442`*^9}, {3.8417129712168913`*^9, 
   3.8417130203166904`*^9}, {3.8417131642173843`*^9, 3.841713170623455*^9}, {
   3.841713234436464*^9, 3.8417132925498095`*^9}, {3.8417157631606073`*^9, 
   3.841715765796726*^9}, {3.8417187076625137`*^9, 3.8417187508433094`*^9}, {
   3.8417188076703005`*^9, 3.841718807971058*^9}, {3.8417214788016725`*^9, 
   3.8417215015998974`*^9}, {3.841724453048129*^9, 3.841724455467265*^9}, {
   3.8417255592176104`*^9, 3.841725562306196*^9}, {3.8417268929440804`*^9, 
   3.8417268960837507`*^9}, {3.8417270404808335`*^9, 3.841727040728004*^9}, {
   3.842165948398032*^9, 3.842165948694683*^9}, {3.842166173233593*^9, 
   3.8421661895264235`*^9}, {3.842166316395509*^9, 3.8421663197350435`*^9}, {
   3.842166370915474*^9, 3.8421663884678636`*^9}, {3.842166457505954*^9, 
   3.8421665082770004`*^9}, {3.842166593700954*^9, 3.842166599235941*^9}, {
   3.8421666595469527`*^9, 3.842166663131195*^9}, {3.8421679518416357`*^9, 
   3.842167954326661*^9}, {3.842168191103377*^9, 3.84216819628564*^9}, {
   3.8421707370003443`*^9, 3.842170768369178*^9}, {3.8421708123212743`*^9, 
   3.8421708159470315`*^9}, {3.8421709090248547`*^9, 3.842170976194894*^9}, {
   3.842171399704073*^9, 3.8421714018932242`*^9}, {3.842171628362564*^9, 
   3.842171628754074*^9}, {3.842172314719325*^9, 3.842172315173855*^9}, {
   3.8421726492749643`*^9, 3.842172727929878*^9}, {3.8422528940169783`*^9, 
   3.8422529593807516`*^9}, {3.842253529017812*^9, 3.8422535333969917`*^9}, {
   3.8422569151990004`*^9, 3.842256943460517*^9}, {3.84232605303971*^9, 
   3.8423260564494963`*^9}, 3.842327060261856*^9, {3.842327092197364*^9, 
   3.8423271258655796`*^9}, {3.842358700045442*^9, 3.8423587416491485`*^9}, {
   3.8423611456941195`*^9, 3.842361147728932*^9}, {3.8435288207565403`*^9, 
   3.843528824599421*^9}, {3.843529341006932*^9, 3.843529345884651*^9}, {
   3.843530889869591*^9, 3.8435309592210836`*^9}, {3.8435309900308094`*^9, 
   3.843531004843729*^9}, {3.8435311671620293`*^9, 3.843531170181957*^9}, {
   3.843531821256488*^9, 3.8435318296039686`*^9}, 3.8435319063290915`*^9, 
   3.8435347522665205`*^9, {3.8435545530310435`*^9, 3.843554560135171*^9}, 
   3.843571773966465*^9, {3.843571858849655*^9, 3.8435718726421547`*^9}, {
   3.843571951157938*^9, 3.8435719581703835`*^9}, {3.843572227071797*^9, 
   3.8435722753073745`*^9}, {3.8435723086499944`*^9, 3.843572348631474*^9}, {
   3.843572417097124*^9, 3.843572446904155*^9}, {3.843572631573713*^9, 
   3.8435726582489777`*^9}, {3.8435728833431625`*^9, 3.843572886629261*^9}, {
   3.843574422241166*^9, 3.8435746264923415`*^9}, {3.8435751698281236`*^9, 
   3.843575175174802*^9}, {3.8435753024007344`*^9, 3.843575304529011*^9}, {
   3.84357655442076*^9, 3.843576554815736*^9}, 3.8437383176856594`*^9, 
   3.843738352335886*^9, {3.8437384596280317`*^9, 3.843738468817902*^9}, {
   3.8437385006760798`*^9, 3.843738509001302*^9}, {3.844778274942865*^9, 
   3.8447782753594856`*^9}, {3.8447785455611353`*^9, 
   3.8447785717243977`*^9}, {3.844778679798833*^9, 3.8447787093864827`*^9}, {
   3.84493665977671*^9, 3.844936683185116*^9}, {3.844936713624093*^9, 
   3.844936722287592*^9}, {3.8449368234449544`*^9, 3.8449368241160135`*^9}, {
   3.8449376756663404`*^9, 3.8449376874331913`*^9}, {3.844939058698762*^9, 
   3.844939182126483*^9}, {3.844939217763793*^9, 3.844939411840272*^9}, {
   3.844939472525874*^9, 3.8449394738928137`*^9}, {3.8449395082900496`*^9, 
   3.8449395222778053`*^9}, {3.8449399298303347`*^9, 3.844939930216208*^9}, {
   3.845297110364465*^9, 3.845297118494326*^9}, {3.845439417765768*^9, 
   3.8454394701867743`*^9}, {3.845439520601866*^9, 3.845439537819277*^9}, {
   3.8454396029261475`*^9, 3.845439604657489*^9}, {3.8454407468644733`*^9, 
   3.8454407644167757`*^9}, 3.845441481686779*^9, {3.8454415602535505`*^9, 
   3.8454415702848907`*^9}, {3.8454429424699707`*^9, 3.845442942620577*^9}, {
   3.8455431801445966`*^9, 3.8455432166778584`*^9}, {3.845543292835795*^9, 
   3.845543310347224*^9}, {3.8455434926294613`*^9, 3.8455435064097457`*^9}, {
   3.8456468626786127`*^9, 3.8456468649397182`*^9}, {3.84564853163152*^9, 
   3.8456485524032297`*^9}, {3.8456491038937817`*^9, 3.845649105788786*^9}, {
   3.845649181004294*^9, 3.845649182238691*^9}, {3.8456540047389264`*^9, 
   3.8456540052593126`*^9}, {3.846048080519809*^9, 3.8460481212169085`*^9}, {
   3.8460481643250985`*^9, 3.846048164456745*^9}, {3.8460499523667326`*^9, 
   3.8460499838855753`*^9}, {3.846080372105716*^9, 3.846080372413828*^9}, {
   3.84608074915252*^9, 3.8460807493041143`*^9}, 3.846314747177179*^9, {
   3.847438047819146*^9, 3.847438060394027*^9}, {3.8478651485417156`*^9, 
   3.8478651487106996`*^9}, {3.847866224638543*^9, 3.847866225942832*^9}, {
   3.847867208401314*^9, 3.8478672085861516`*^9}, {3.848040453230745*^9, 
   3.848040454752204*^9}, 3.8480420405468903`*^9, {3.848060748635537*^9, 
   3.8480607504573793`*^9}, {3.848063244280815*^9, 3.848063253083206*^9}, {
   3.849160645935732*^9, 3.8491606516750584`*^9}, {3.8557219188168917`*^9, 
   3.8557219294051275`*^9}, {3.8846670338247833`*^9, 
   3.8846670346467834`*^9}, {3.885975116016577*^9, 3.8859751169522133`*^9}, {
   3.885977516441806*^9, 3.8859775169104156`*^9}, {3.8859777408702497`*^9, 
   3.8859777417411203`*^9}, {3.885977848116682*^9, 3.8859778493534384`*^9}, {
   3.885977965298321*^9, 3.8859779669379606`*^9}, {3.886048425425521*^9, 
   3.8860484635880756`*^9}, {3.8860485726081696`*^9, 
   3.8860485785088005`*^9}, {3.88605030944866*^9, 3.8860503145142345`*^9}, {
   3.886050383335536*^9, 3.886050625100605*^9}, {3.886050668512599*^9, 
   3.886050716352436*^9}},ExpressionUUID->"521cbb09-0da3-415f-8c45-\
b7a76a82b6f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "activation", " ", 
    RowBox[{"function", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"1.", "/", 
     RowBox[{"(", 
      RowBox[{"1.", "+", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", "x"}], "]"}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "6."}], ",", "6."}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.845439905094378*^9, 3.8454400319716787`*^9}, {
   3.8454422907412353`*^9, 3.8454423253502617`*^9}, {3.8454430037795935`*^9, 
   3.8454430179794407`*^9}, {3.8454430508399315`*^9, 
   3.8454430596863604`*^9}, {3.8456454926659713`*^9, 3.84564557201076*^9}, {
   3.845645616081752*^9, 3.845645643062753*^9}, 3.8462118146690273`*^9, {
   3.8463071277068186`*^9, 3.8463071355823393`*^9}, {3.8463146193829813`*^9, 
   3.846314619662775*^9}, {3.886058613963586*^9, 
   3.8860586281611156`*^9}},ExpressionUUID->"05efebbb-afdf-412e-a55e-\
a49053bac8af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", "1"}], ";", 
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"m", "\[LessEqual]", "runs"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initial", " ", "weights", " ", "are", " ", "randomly", " ", 
      RowBox[{"generated", ".", " ", "Then"}], " ", "the", " ", "weights", 
      " ", "between", " ", "the", " ", "input", " ", "and", " ", "hidden", 
      " ", "layers", " ", "are", " ", 
      RowBox[{"rescaled", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"whi1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1."}], ",", "1."}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "hlsize"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "fsize"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "hlsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"whi1", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"whi1", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "/", 
          RowBox[{"Norm", "[", 
           RowBox[{"whi1", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"whi2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1."}], ",", "1."}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "hlsize"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "fsize"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "hlsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"whi2", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"whi2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "/", 
          RowBox[{"Norm", "[", 
           RowBox[{"whi2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"wout1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1."}], ",", "1."}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "19"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"hlsize", "+", "fsize"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wout2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1."}], ",", "1."}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "19"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"hlsize", "+", "fsize"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Initial", " ", "values", " ", "of", " ", "the", " ", "counters", " ", 
       "for", " ", "epsilon", " ", "and", " ", 
       RowBox[{"alpha", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ialpha", "=", 
      RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ieps", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Tables", " ", "to", " ", "be", " ", "used", " ", "for", " ", 
       "calculating", " ", 
       RowBox[{"RSI", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rsip", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "15"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsiu", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "14"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsid", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "14"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Variables", " ", "for", " ", "the", " ", "average", " ", "volumes", 
       " ", "and", " ", "the", " ", "max", " ", "norms", " ", "of", " ", 
       "the", " ", "output", " ", 
       RowBox[{"weights", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mv", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "20"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nv", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"av", "=", "0."}], ";", "\[IndentingNewLine]", 
     RowBox[{"max1", "=", "1."}], ";", "\[IndentingNewLine]", 
     RowBox[{"max2", "=", "1."}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Initial", " ", "mon"}], ",", " ", "cns", ",", " ", "sav", ",",
        " ", "res", ",", " ", 
       RowBox[{"mlim", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mon", "=", "100."}], ";", 
     RowBox[{"cns", "=", "0."}], ";", " ", 
     RowBox[{"sav", "=", "0."}], ";", 
     RowBox[{"res", "=", "0."}], ";", 
     RowBox[{"mlim", "=", "mon"}], ";", 
     RowBox[{"mdf", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "episode", "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Label", " ", "used", " ", "to", " ", "start", " ", "a", " ", "new", 
       " ", 
       RowBox[{"episode", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Initial", " ", "price", " ", "in", " ", "the", " ", 
       RowBox[{"episode", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ipr", "=", 
      RowBox[{"prices", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "*", "5"}], "-", "vsize", "+", "1"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculate", " ", "the", " ", "average", " ", 
       RowBox[{"volumes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cav", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "*", "5"}], "-", "4"}], "]"}], "]"}], "+", 
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "*", "5"}], "-", "3"}], "]"}], "]"}], "+", 
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "*", "5"}], "-", "2"}], "]"}], "]"}], "+", 
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "*", "5"}], "-", "1"}], "]"}], "]"}], "+", 
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}], "/", "5."}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "19"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"mv", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"mv", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "=", "cav"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"av", "=", 
      RowBox[{"Mean", "[", "mv", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Observe", " ", "the", " ", "prices", " ", "in", " ", "the", " ", 
       "current", " ", 
       RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "vsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"pr", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"prices", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", "*", "5"}], "-", "vsize", "+", "j"}], "]"}], "]"}]}],
         ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Relative", " ", "price", " ", 
       RowBox[{"movements", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "1"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nmd1", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pr", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{"pr", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"pr", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nmd2", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"nmd1", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{"nmd1", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"Abs", "[", 
           RowBox[{"nmd1", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "3"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nmd3", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"nmd2", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{"nmd2", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"Abs", "[", 
           RowBox[{"nmd2", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "4"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nmd4", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"nmd3", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{"nmd3", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"Abs", "[", 
           RowBox[{"nmd3", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculate", " ", "RSI", " ", "for", " ", "15", " ", 
       RowBox[{"points", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "10"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"rsip", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"rsip", "[", 
          RowBox[{"[", 
           RowBox[{"j", "+", "5"}], "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "vsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"rsip", "[", 
          RowBox[{"[", 
           RowBox[{"10", "+", "j"}], "]"}], "]"}], "=", 
         RowBox[{"pr", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "14"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rsip", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], ">", 
           RowBox[{"rsip", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rsiu", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"rsip", "[", 
              RowBox[{"[", 
               RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
             RowBox[{"rsip", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
           RowBox[{
            RowBox[{"rsid", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rsip", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "<", 
           RowBox[{"rsip", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rsid", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"rsip", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "-", 
             RowBox[{"rsip", "[", 
              RowBox[{"[", 
               RowBox[{"j", "+", "1"}], "]"}], "]"}]}]}], ";", 
           RowBox[{
            RowBox[{"rsiu", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rsip", "[", 
            RowBox[{"[", 
             RowBox[{"j", "+", "1"}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"rsip", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rsiu", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "0."}], ";", 
           RowBox[{
            RowBox[{"rsid", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "[", "rsid", "]"}], "\[Equal]", "0."}], ",", 
       RowBox[{"rsi", "=", "100."}], ",", 
       RowBox[{"rsi", "=", 
        RowBox[{"100.", "-", 
         RowBox[{"(", 
          RowBox[{"100.", "/", 
           RowBox[{"(", 
            RowBox[{"1.", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Mean", "[", "rsiu", "]"}], "/", 
               RowBox[{"Mean", "[", "rsid", "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Construct", " ", "the", " ", "feature", " ", "vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"same", " ", "for", " ", "all", " ", "actions"}], ")"}], 
        "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "0."}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"k", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "vsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"pr", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "ipr"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pr", "[", 
          RowBox[{"[", "vsize", "]"}], "]"}], "-", "ipr"}], ")"}], "/", 
       "ipr"}]}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "mon"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "cns"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "cav"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "av"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cav", "-", "av"}], ")"}], "/", "av"}]}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{"i", "*", "5"}], "]"}], "]"}], "-", "av"}], ")"}], "/", 
       "av"}]}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"volumes", "[", 
          RowBox[{"[", 
           RowBox[{"i", "*", "5"}], "]"}], "]"}], "-", "cav"}], ")"}], "/", 
       "cav"}]}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "rsi"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "1"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"nmd1", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "2"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"nmd2", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "3"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"nmd3", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"vsize", "-", "4"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"nmd4", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", 
        RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "mlim"}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Rescale", " ", "the", " ", "feature", " ", "vector"}], ",", 
       " ", 
       RowBox[{"so", " ", "its", " ", "norm", " ", "is", " ", "6."}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"feat", "=", 
      RowBox[{"6.", "*", 
       RowBox[{"(", 
        RowBox[{"feat", "/", 
         RowBox[{"Norm", "[", "feat", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"feat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "1."}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Output", " ", "of", " ", "the", " ", "hidden", " ", 
       RowBox[{"layers", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"n", "\[LessEqual]", "hlsize"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", "=", "0"}], ";", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
          RowBox[{
           RowBox[{"q", "=", 
            RowBox[{"q", "+", 
             RowBox[{
              RowBox[{"whi1", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"feat", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hlayer1", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{"1.", "/", 
          RowBox[{"(", 
           RowBox[{"1.", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "q"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q", "=", "0"}], ";", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
          RowBox[{
           RowBox[{"q", "=", 
            RowBox[{"q", "+", 
             RowBox[{
              RowBox[{"whi2", "[", 
               RowBox[{"[", 
                RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"feat", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hlayer2", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{"1.", "/", 
          RowBox[{"(", 
           RowBox[{"1.", "+", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", "q"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"n", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Gradients", " ", "of", " ", "the", " ", "Q"}], "-", 
        "functions"}], ",", " ", 
       RowBox[{
       "taken", " ", "in", " ", "the", " ", "current", " ", "state", " ", 
        RowBox[{"(", 
         RowBox[{"same", " ", "for", " ", "all", " ", "actions"}], ")"}]}], 
       ",", " ", 
       RowBox[{
       "which", " ", "are", " ", "just", " ", "concatenations", " ", "of", 
        " ", "the", " ", "feature", " ", "vector", " ", "with", " ", "the", 
        " ", "hidden", " ", "layer", " ", 
        RowBox[{"outputs", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"gradq1", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"feat", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "hlsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"gradq1", "[", 
          RowBox[{"[", 
           RowBox[{"fsize", "+", "j"}], "]"}], "]"}], "=", 
         RowBox[{"hlayer1", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"gradq2", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"feat", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "\[LessEqual]", "hlsize"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"gradq2", "[", 
          RowBox[{"[", 
           RowBox[{"fsize", "+", "j"}], "]"}], "]"}], "=", 
         RowBox[{"hlayer2", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", 
        RowBox[{"j", "=", 
         RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "wth", " ", "in", " ", "the", " ", "current", " ", 
       RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"wth", "=", 
      RowBox[{"mon", "+", 
       RowBox[{"(", 
        RowBox[{"cns", "*", 
         RowBox[{"prices", "[", 
          RowBox[{"[", 
           RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "\[LessEqual]", 
        "simlength"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Calculate", " ", "Q1", " ", "and", " ", "Q2", " ", "for", " ", 
         "every", " ", "action", " ", "in", " ", "the", " ", "given", " ", 
         RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"n", "\[LessEqual]", "19"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "=", "0"}], ";", 
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"hlsize", "+", "fsize"}]}], ",", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"q", "+", 
                RowBox[{
                 RowBox[{"wout1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"gradq1", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              RowBox[{"j", "=", 
               RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"qarr1", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "=", "q"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"q", "=", "0"}], ";", 
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"hlsize", "+", "fsize"}]}], ",", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"q", "+", 
                RowBox[{
                 RowBox[{"wout2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"gradq2", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              RowBox[{"j", "=", 
               RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"qarr2", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "=", "q"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"n", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Calculate", " ", "the", " ", "average", " ", "of", " ", "Q1", " ", 
           "and", " ", "Q2"}], ",", " ", 
          RowBox[{
          "which", " ", "is", " ", "needed", " ", "to", " ", "choose", " ", 
           "an", " ", 
           RowBox[{"action", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"qarr", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"qarr1", "+", "qarr2"}], ")"}], "/", "2."}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", 
          RowBox[{"epsilon", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rand", "=", 
         RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rand", "\[LessEqual]", "probeps"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"ieps", "\[GreaterEqual]", 
              RowBox[{"Ceiling", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"1.", "/", "0.2"}], "]"}], "-", "2."}], ")"}], "/",
                 "5."}], "]"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"ieps", "=", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"1.", "/", "0.2"}], "]"}], "-", "2."}], ")"}], "/", 
             "5."}], "]"}]}], ",", 
          RowBox[{"ieps", "=", 
           RowBox[{"ieps", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"eps", "=", 
         RowBox[{"1.", "/", 
          RowBox[{"Log", "[", 
           RowBox[{
            RowBox[{"ieps", "*", "5."}], "+", "2."}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Choose", " ", "an", " ", 
          RowBox[{"action", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rand", "=", 
         RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rand", "\[LessEqual]", "eps"}], ",", 
          RowBox[{"a", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "19"}], "}"}], "]"}]}], ",", 
          RowBox[{"a", "=", 
           RowBox[{
            RowBox[{"Ordering", "[", 
             RowBox[{"qarr", ",", 
              RowBox[{"-", "1"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", 
          RowBox[{"alpha", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ialpha", "=", 
         RowBox[{"ialpha", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"alpha", "=", 
         RowBox[{"0.001", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1.", "/", "2."}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1.", "-", "0.001"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"1.", "+", 
             RowBox[{"Cos", "[", 
              RowBox[{"Pi", "*", 
               RowBox[{"ialpha", "/", "1000."}]}], "]"}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Take", " ", "the", " ", "chosen", " ", 
          RowBox[{"action", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fff", "=", "1."}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
         "This", " ", "tracks", " ", "for", " ", "insufficient", " ", "mon", 
          " ", "or", " ", "cns", " ", "in", " ", "order", " ", "to", " ", 
          "reflect", " ", "it", " ", "in", " ", "the", " ", "reward", " ", 
          RowBox[{"later", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "10."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"10.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "10."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "20."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"20.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "20."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "3"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "30."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"30.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "30."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "4"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "40."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"40.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "40."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "5"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "50."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"50.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "50."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "6"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "60."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"60.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "60."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "7"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "70."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"70.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "70."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "8"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "80."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"80.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "80."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "9"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mon", "<", "90."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"90.", "/", 
                 RowBox[{"prices", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}], 
              ")"}]}]}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "-", "90."}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "10"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "10."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "10.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"10.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "11"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "20."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "20.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"20.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "12"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "30."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "30.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"30.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "13"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "40."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "40.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"40.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "14"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "50."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "50.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"50.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "15"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "60."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "60.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"60.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "16"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "70."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "70.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"70.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "17"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "80."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "80.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"80.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "18"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}], "*", "cns"}], "<", 
              "90."}], ",", 
             RowBox[{
              RowBox[{"fff", "=", 
               RowBox[{"-", "1."}]}], ";", 
              RowBox[{"Goto", "[", "fail", "]"}]}]}], "]"}], ";", 
           RowBox[{"mon", "=", 
            RowBox[{"mon", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"99.9", "/", "100."}], ")"}], "*", 
               RowBox[{"(", "90.", ")"}]}], ")"}]}]}], ";", 
           RowBox[{"cns", "=", 
            RowBox[{"cns", "-", 
             RowBox[{"(", 
              RowBox[{"90.", "/", 
               RowBox[{"prices", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "*", "5"}], "]"}], "]"}]}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"a", "\[Equal]", "19"}], ",", "HOLD"}], "]"}], ";"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Label", "[", "fail", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"mon", "<", "0."}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{"cns", "<", "0."}], ")"}]}], ")"}], ",", 
          RowBox[{"Print", "[", "\"\<Negative mon or cns!\>\"", "]"}]}], 
         "]"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"Just", " ", "to", " ", "be", " ", 
          RowBox[{"sure", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Observe", " ", "the", " ", "reward", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "by", " ", "calculating", " ", "wth", " ", "in", " ", "the", " ", 
             "next", " ", "state"}], ")"}], "."}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"wthnew", "=", 
         RowBox[{"mon", "+", 
          RowBox[{"(", 
           RowBox[{"cns", "*", 
            RowBox[{"prices", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "]"}], "]"}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rew", "=", 
         RowBox[{"wthnew", "-", "wth"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"fff", "<", "0."}], ",", "\[IndentingNewLine]", 
          RowBox[{"rew", "=", 
           RowBox[{"rew", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rew", "/", "2."}], ")"}], "^", "2"}], ")"}], "-", 
            "0.1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"rew", "=", 
           RowBox[{"rew", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rew", "/", "2."}], ")"}], "^", "2"}], ")"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Observe", " ", "the", " ", "prices", " ", "in", " ", "the", " ", 
          "next", " ", 
          RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "vsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"pr", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"prices", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "-", "vsize", 
               "+", "j"}], "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "RSI", " ", "for", " ", "15", " ", 
          RowBox[{"points", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "10"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rsip", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"rsip", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "5"}], "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "vsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"rsip", "[", 
             RowBox[{"[", 
              RowBox[{"10", "+", "j"}], "]"}], "]"}], "=", 
            RowBox[{"pr", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "14"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rsip", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], ">", 
              RowBox[{"rsip", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"rsiu", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"rsip", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"rsip", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
              RowBox[{
               RowBox[{"rsid", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rsip", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], "<", 
              RowBox[{"rsip", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"rsid", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"rsip", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "-", 
                RowBox[{"rsip", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}]}]}], ";", 
              RowBox[{
               RowBox[{"rsiu", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rsip", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"rsip", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"rsiu", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", "0."}], ";", 
              RowBox[{
               RowBox[{"rsid", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", "0."}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mean", "[", "rsid", "]"}], "\[Equal]", "0."}], ",", 
          RowBox[{"rsi", "=", "100."}], ",", 
          RowBox[{"rsi", "=", 
           RowBox[{"100.", "-", 
            RowBox[{"(", 
             RowBox[{"100.", "/", 
              RowBox[{"(", 
               RowBox[{"1.", "+", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Mean", "[", "rsiu", "]"}], "/", 
                  RowBox[{"Mean", "[", "rsid", "]"}]}], ")"}]}], ")"}]}], 
             ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Check", " ", "for", " ", "the", " ", "three", " ", "possible", " ", 
          "terminal", " ", 
          RowBox[{"states", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mon", ">", "mlim"}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{"Terminal", " ", "state", " ", "1."}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rew", "=", 
            RowBox[{"rew", "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"mon", "-", "mlim"}], ")"}], "*", "0.34"}], ")"}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"rand", "=", 
            RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rand", "\[LessEqual]", "0.5"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"wout1", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"wout1", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], "+", 
                RowBox[{"alpha", "*", 
                 RowBox[{"(", 
                  RowBox[{"rew", "-", 
                   RowBox[{"qarr1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", 
                 "gradq1"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"max1", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"max1", ",", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"wout1", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"wout1", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
                RowBox[{
                 RowBox[{"wout1", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"wout1", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "/", "max1"}]}]}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"wout2", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"wout2", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], "+", 
                RowBox[{"alpha", "*", 
                 RowBox[{"(", 
                  RowBox[{"rew", "-", 
                   RowBox[{"qarr2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", 
                 "gradq2"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"max2", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"max2", ",", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"wout2", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"wout2", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
                RowBox[{
                 RowBox[{"wout2", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"wout2", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "/", "max2"}]}]}], 
               "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"mdf", "=", 
            RowBox[{"mon", "-", "mlim"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"sav", "=", 
            RowBox[{"sav", "+", 
             RowBox[{"(", 
              RowBox[{"mdf", "*", "0.34"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"res", "=", 
            RowBox[{"res", "+", 
             RowBox[{"(", 
              RowBox[{"mdf", "*", "0.33"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mon", "=", 
            RowBox[{"mlim", "+", 
             RowBox[{"(", 
              RowBox[{"mdf", "*", "0.33"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mlim", "=", 
            RowBox[{"mon", "+", "mdf"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"i", "=", 
            RowBox[{"i", "+", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "*", "5"}], ">", "simlength"}], ",", 
             RowBox[{"Goto", "[", "break", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Goto", "[", "episode", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"wthnew", "<", "mlimn"}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"qarr", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], ">", "0."}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{"rsi", ">", "70."}], ")"}]}], ")"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{"Terminal", " ", "state", " ", "2."}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rand", "=", 
               RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rand", "\[LessEqual]", "0.5"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"wout1", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "+", 
                   RowBox[{"alpha", "*", 
                    RowBox[{"(", 
                    RowBox[{"rew", "-", 
                    RowBox[{"qarr1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", 
                    "gradq1"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"max1", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"max1", ",", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
                   RowBox[{
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "/", "max1"}]}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"wout2", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "+", 
                   RowBox[{"alpha", "*", 
                    RowBox[{"(", 
                    RowBox[{"rew", "-", 
                    RowBox[{"qarr2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", 
                    "gradq2"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"max2", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"max2", ",", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
                   RowBox[{
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "/", "max2"}]}]}], 
                  "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"mon", "=", 
               RowBox[{"mon", "+", 
                RowBox[{"(", 
                 RowBox[{"res", "/", "2."}], ")"}]}]}], ";", 
              RowBox[{"res", "=", 
               RowBox[{"res", "-", 
                RowBox[{"(", 
                 RowBox[{"res", "/", "2."}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"mon", "\[GreaterEqual]", "mlimn"}], ",", 
                RowBox[{"mlim", "=", "mon"}], ",", 
                RowBox[{"mlim", "=", "mlimn"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"i", "=", 
               RowBox[{"i", "+", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "*", "5"}], ">", "simlength"}], ",", 
                RowBox[{"Goto", "[", "break", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Goto", "[", "episode", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"wthnew", "\[GreaterEqual]", "mlimn"}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"qarr", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], "<", "0."}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{"rsi", "<", "30."}], ")"}]}], ")"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{"Terminal", " ", "state", " ", "3."}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rand", "=", 
               RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rand", "\[LessEqual]", "0.5"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"wout1", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "+", 
                   RowBox[{"alpha", "*", 
                    RowBox[{"(", 
                    RowBox[{"rew", "-", 
                    RowBox[{"qarr1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", 
                    "gradq1"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"max1", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"max1", ",", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
                   RowBox[{
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"wout1", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "/", "max1"}]}]}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"wout2", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "+", 
                   RowBox[{"alpha", "*", 
                    RowBox[{"(", 
                    RowBox[{"rew", "-", 
                    RowBox[{"qarr2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", 
                    "gradq2"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"max2", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{"max2", ",", 
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Norm", "[", 
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
                   RowBox[{
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"wout2", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "/", "max2"}]}]}], 
                  "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"mlim", "=", "wthnew"}], ";", "\[IndentingNewLine]", 
              RowBox[{"i", "=", 
               RowBox[{"i", "+", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "*", "5"}], ">", "simlength"}], ",", 
                RowBox[{"Goto", "[", "break", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Goto", "[", "episode", "]"}]}]}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Calculate", " ", "the", " ", "average", " ", 
          RowBox[{"volumes", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"cav", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "-", "4"}], 
              "]"}], "]"}], "+", 
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "-", "3"}], 
              "]"}], "]"}], "+", 
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "-", "2"}], 
              "]"}], "]"}], "+", 
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "-", "1"}], 
              "]"}], "]"}], "+", 
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "]"}], "]"}]}], 
           ")"}], "/", "5."}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "19"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"mv", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"mv", "[", 
             RowBox[{"[", 
              RowBox[{"j", "+", "1"}], "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mv", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", "cav"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"av", "=", 
         RowBox[{"Mean", "[", "mv", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Relative", " ", "price", " ", 
          RowBox[{"movements", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nmd1", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"pr", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{"pr", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"pr", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nmd2", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nmd1", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{"nmd1", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"Abs", "[", 
              RowBox[{"nmd1", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "3"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nmd3", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nmd2", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{"nmd2", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"Abs", "[", 
              RowBox[{"nmd2", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "4"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nmd4", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nmd3", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{"nmd3", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"Abs", "[", 
              RowBox[{"nmd3", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Construct", " ", "the", " ", "feature", " ", "vector", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"same", " ", "for", " ", "all", " ", "actions"}], ")"}], 
           "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "0."}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"k", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "vsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"feat", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"pr", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"k", "=", 
            RowBox[{"k", "+", "1"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "ipr"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pr", "[", 
             RowBox[{"[", "vsize", "]"}], "]"}], "-", "ipr"}], ")"}], "/", 
          "ipr"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "mon"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "cns"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "cav"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "av"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cav", "-", "av"}], ")"}], "/", "av"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "]"}], "]"}], "-",
             "av"}], ")"}], "/", "av"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"volumes", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", "1"}], ")"}], "*", "5"}], "]"}], "]"}], "-",
             "cav"}], ")"}], "/", "cav"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "rsi"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "1"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"feat", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"nmd1", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"k", "=", 
            RowBox[{"k", "+", "1"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "2"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"feat", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"nmd2", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"k", "=", 
            RowBox[{"k", "+", "1"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "3"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"feat", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"nmd3", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"k", "=", 
            RowBox[{"k", "+", "1"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"vsize", "-", "4"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"feat", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
            RowBox[{"nmd4", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"k", "=", 
            RowBox[{"k", "+", "1"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", 
           RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", "mlim"}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"k", "+", "1"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Rescale", " ", "the", " ", "feature", " ", "vector"}], ",",
           " ", 
          RowBox[{"so", " ", "its", " ", "norm", " ", "is", " ", "6."}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"feat", "=", 
         RowBox[{"6.", "*", 
          RowBox[{"(", 
           RowBox[{"feat", "/", 
            RowBox[{"Norm", "[", "feat", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"feat", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", "1."}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Output", " ", "of", " ", "the", " ", "hidden", " ", 
          RowBox[{"layers", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"n", "\[LessEqual]", "hlsize"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "=", "0"}], ";", 
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"q", "+", 
                RowBox[{
                 RowBox[{"whi1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"feat", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              RowBox[{"j", "=", 
               RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hlayer1", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "=", 
            RowBox[{"1.", "/", 
             RowBox[{"(", 
              RowBox[{"1.", "+", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", "q"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"q", "=", "0"}], ";", 
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"q", "+", 
                RowBox[{
                 RowBox[{"whi2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"feat", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              RowBox[{"j", "=", 
               RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hlayer2", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "=", 
            RowBox[{"1.", "/", 
             RowBox[{"(", 
              RowBox[{"1.", "+", 
               RowBox[{"Exp", "[", 
                RowBox[{"-", "q"}], "]"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"n", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Gradients", " ", "of", " ", "the", " ", "Q"}], "-", 
           "functions"}], ",", " ", 
          RowBox[{
          "taken", " ", "in", " ", "the", " ", "next", " ", "state", " ", 
           RowBox[{"(", 
            RowBox[{"same", " ", "for", " ", "all", " ", "actions"}], ")"}]}],
           ",", " ", 
          RowBox[{
          "which", " ", "are", " ", "just", " ", "concatenations", " ", "of", 
           " ", "the", " ", "feature", " ", "vector", " ", "with", " ", "the",
            " ", "hidden", " ", "layer", " ", 
           RowBox[{"outputs", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"gradq1new", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"feat", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "hlsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"gradq1new", "[", 
             RowBox[{"[", 
              RowBox[{"fsize", "+", "j"}], "]"}], "]"}], "=", 
            RowBox[{"hlayer1", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "fsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"gradq2new", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "=", 
            RowBox[{"feat", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", "hlsize"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"gradq2new", "[", 
             RowBox[{"[", 
              RowBox[{"fsize", "+", "j"}], "]"}], "]"}], "=", 
            RowBox[{"hlayer2", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", 
           RowBox[{"j", "=", 
            RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Calculate", " ", "Q1", " ", "and", " ", "Q2", " ", "for", " ", 
          "every", " ", "action", " ", "in", " ", "the", " ", "next", " ", 
          RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"n", "=", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"n", "\[LessEqual]", "19"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "=", "0"}], ";", 
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"hlsize", "+", "fsize"}]}], ",", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"q", "+", 
                RowBox[{
                 RowBox[{"wout1", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"gradq1new", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              RowBox[{"j", "=", 
               RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"qarr1new", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "=", "q"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"q", "=", "0"}], ";", 
           RowBox[{"j", "=", "1"}], ";", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"j", "\[LessEqual]", 
              RowBox[{"hlsize", "+", "fsize"}]}], ",", 
             RowBox[{
              RowBox[{"q", "=", 
               RowBox[{"q", "+", 
                RowBox[{
                 RowBox[{"wout2", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"gradq2new", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
              RowBox[{"j", "=", 
               RowBox[{"j", "+", "1"}]}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"qarr2new", "[", 
             RowBox[{"[", "n", "]"}], "]"}], "=", "q"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"n", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Update", " ", "the", " ", "output", " ", 
          RowBox[{"weights", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"rand", "=", 
         RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rand", "\[LessEqual]", "0.5"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amax", "=", 
            RowBox[{
             RowBox[{"Ordering", "[", 
              RowBox[{"qarr1new", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"wout1", "[", 
             RowBox[{"[", "a", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"wout1", "[", 
              RowBox[{"[", "a", "]"}], "]"}], "+", 
             RowBox[{"alpha", "*", 
              RowBox[{"(", 
               RowBox[{"rew", "+", 
                RowBox[{"gamma", "*", 
                 RowBox[{"qarr2new", "[", 
                  RowBox[{"[", "amax", "]"}], "]"}]}], "-", 
                RowBox[{"qarr1", "[", 
                 RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", "gradq1"}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"max1", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"max1", ",", 
              RowBox[{"Norm", "[", 
               RowBox[{"wout1", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"wout1", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
             RowBox[{
              RowBox[{"wout1", "[", 
               RowBox[{"[", "a", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"wout1", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "/", "max1"}]}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"amax", "=", 
            RowBox[{
             RowBox[{"Ordering", "[", 
              RowBox[{"qarr2new", ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"wout2", "[", 
             RowBox[{"[", "a", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"wout2", "[", 
              RowBox[{"[", "a", "]"}], "]"}], "+", 
             RowBox[{"alpha", "*", 
              RowBox[{"(", 
               RowBox[{"rew", "+", 
                RowBox[{"gamma", "*", 
                 RowBox[{"qarr1new", "[", 
                  RowBox[{"[", "amax", "]"}], "]"}]}], "-", 
                RowBox[{"qarr2", "[", 
                 RowBox[{"[", "a", "]"}], "]"}]}], ")"}], "*", "gradq2"}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"max2", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"max2", ",", 
              RowBox[{"Norm", "[", 
               RowBox[{"wout2", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"wout2", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "]"}], ">", "1."}], ",", 
             RowBox[{
              RowBox[{"wout2", "[", 
               RowBox[{"[", "a", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"wout2", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "/", "max2"}]}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Make", " ", "the", " ", "next", " ", "value", " ", "of", " ", "wth",
           " ", "and", " ", "the", " ", "next", " ", "states", " ", 
          RowBox[{"current", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"wth", "=", "wthnew"}], ";", "\[IndentingNewLine]", 
        RowBox[{"gradq1", "=", "gradq1new"}], ";", "\[IndentingNewLine]", 
        RowBox[{"gradq2", "=", "gradq2new"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "=", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "break", "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Label", " ", "used", " ", "to", " ", "exit", " ", "the", " ", 
        "loop"}], ",", " ", 
       RowBox[{
       "if", " ", "there", " ", "are", " ", "no", " ", "more", " ", "points", 
        " ", "in", " ", "the", " ", "test", " ", 
        RowBox[{"data", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"savarray", "[", 
       RowBox[{"[", "m", "]"}], "]"}], "=", "sav"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Write", " ", "sav", " ", "at", " ", "the", " ", "end", " ", "of", " ", 
       "the", " ", "current", " ", 
       RowBox[{"run", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"twtharray", "[", 
       RowBox[{"[", "m", "]"}], "]"}], "=", 
      RowBox[{"sav", "+", "wthnew", "+", "res"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Write", " ", "twth", " ", "at", " ", "the", " ", "end", " ", "of", " ",
        "the", " ", "current", " ", 
       RowBox[{"run", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"m", "+", "1"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.841714955131351*^9, 3.841715143587838*^9}, {
   3.8417152117502637`*^9, 3.841715224878657*^9}, {3.8417153190926905`*^9, 
   3.8417153192400637`*^9}, {3.8417153674567084`*^9, 3.841715435770647*^9}, {
   3.8417154874480553`*^9, 3.8417155288717656`*^9}, {3.8417186744294605`*^9, 
   3.841718705258951*^9}, {3.8417211074168234`*^9, 3.841721135915856*^9}, {
   3.841721318098493*^9, 3.8417213412935605`*^9}, {3.8417214351906805`*^9, 
   3.8417214611783133`*^9}, {3.8417215320781183`*^9, 
   3.8417215493555517`*^9}, {3.8417215869393234`*^9, 
   3.8417216475938797`*^9}, {3.841721930266679*^9, 3.8417219361844635`*^9}, {
   3.841721995702568*^9, 3.841722012502161*^9}, {3.8417220784054484`*^9, 
   3.841722114456072*^9}, 3.8417224806455545`*^9, {3.841722585865542*^9, 
   3.8417226550658665`*^9}, {3.841722755939514*^9, 3.8417227699058332`*^9}, {
   3.841723772100834*^9, 3.841723859095214*^9}, {3.841723921182064*^9, 
   3.84172392133541*^9}, {3.8417242468142595`*^9, 3.84172426787322*^9}, {
   3.841724462450733*^9, 3.8417244681599517`*^9}, {3.8417246786850834`*^9, 
   3.8417246895179615`*^9}, {3.8417249160077543`*^9, 
   3.8417249821505785`*^9}, {3.841725023545573*^9, 3.8417250251014547`*^9}, {
   3.841725067313494*^9, 3.8417250883321724`*^9}, {3.84172522779011*^9, 
   3.8417252349421253`*^9}, {3.8417254512351265`*^9, 
   3.8417254657745295`*^9}, {3.8417255677318316`*^9, 
   3.8417256067446394`*^9}, {3.84172637965143*^9, 3.841726411225021*^9}, {
   3.8417264575429335`*^9, 3.8417265181010227`*^9}, {3.8417265575178294`*^9, 
   3.8417266667899055`*^9}, {3.8417267213807793`*^9, 
   3.8417267397354937`*^9}, {3.841726857077298*^9, 3.8417269141499343`*^9}, {
   3.8417270452081623`*^9, 3.841727057271973*^9}, {3.84172723526834*^9, 
   3.841727459033535*^9}, 3.8417274893485565`*^9, {3.8417275271287994`*^9, 
   3.8417276065113125`*^9}, {3.8417276445963287`*^9, 
   3.8417276481504397`*^9}, {3.8417277281412845`*^9, 
   3.8417277836190834`*^9}, {3.8417281468381634`*^9, 3.841728220240597*^9}, {
   3.8417282800804243`*^9, 3.841728350006184*^9}, {3.8417283806843643`*^9, 
   3.8417284451768403`*^9}, {3.841728482803625*^9, 3.841728620840584*^9}, {
   3.8417286873103743`*^9, 3.8417287556775336`*^9}, {3.8417287915949774`*^9, 
   3.841728916053467*^9}, {3.8417289782847815`*^9, 3.841729076952261*^9}, {
   3.8417291075986032`*^9, 3.8417291557843175`*^9}, {3.8417292075274334`*^9, 
   3.8417294516258388`*^9}, {3.8417294949490013`*^9, 
   3.8417295462686834`*^9}, {3.8417295913915453`*^9, 3.841729605906128*^9}, {
   3.8417296449910617`*^9, 3.841729645438656*^9}, {3.8417359038130713`*^9, 
   3.841735919883686*^9}, {3.8417359564795723`*^9, 3.8417359643505955`*^9}, {
   3.841818554103718*^9, 3.8418185741897354`*^9}, {3.8418372707262993`*^9, 
   3.8418373515280175`*^9}, {3.841837409140319*^9, 3.8418374161792965`*^9}, {
   3.8418374817035856`*^9, 3.8418375044555635`*^9}, {3.8418375710454917`*^9, 
   3.841837596883341*^9}, {3.8418376418523874`*^9, 3.8418377119998255`*^9}, {
   3.8418380347280254`*^9, 3.8418381004234877`*^9}, {3.841838137498169*^9, 
   3.84183819815267*^9}, 3.841838260306661*^9, {3.8418383207392015`*^9, 
   3.84183839543871*^9}, {3.841838488050583*^9, 3.8418384960317187`*^9}, {
   3.8418385737780085`*^9, 3.8418385798766837`*^9}, {3.842166772664339*^9, 
   3.842166795661312*^9}, {3.842166875933236*^9, 3.84216690339937*^9}, {
   3.842166962977703*^9, 3.842166974603242*^9}, {3.842167037390403*^9, 
   3.842167042935722*^9}, {3.8421671296220703`*^9, 3.8421671636829395`*^9}, {
   3.8421679458207617`*^9, 3.8421679756427164`*^9}, {3.84216803111535*^9, 
   3.8421680500056944`*^9}, {3.8421681141972265`*^9, 3.842168159581145*^9}, {
   3.8421682092759223`*^9, 3.842168238296362*^9}, {3.842170407099557*^9, 
   3.8421704100596914`*^9}, {3.8421704964663887`*^9, 
   3.8421706273136816`*^9}, {3.842171070798236*^9, 3.842171145235694*^9}, {
   3.842171189179328*^9, 3.8421712422554445`*^9}, {3.842171350486858*^9, 
   3.8421714394891014`*^9}, {3.842171497478836*^9, 3.8421715303346233`*^9}, {
   3.842171763299408*^9, 3.8421717795846977`*^9}, {3.842172022298125*^9, 
   3.842172051970686*^9}, {3.8421721883503113`*^9, 3.8421721985503283`*^9}, {
   3.842172350739293*^9, 3.8421723543499937`*^9}, {3.8421726002520213`*^9, 
   3.84217262011572*^9}, {3.842172731620615*^9, 3.842172804544901*^9}, {
   3.842172839116335*^9, 3.842172850682444*^9}, {3.8421730506305313`*^9, 
   3.842173098759608*^9}, {3.842173155482574*^9, 3.842173157303884*^9}, {
   3.8421732064931746`*^9, 3.8421732277171106`*^9}, {3.8421734671472054`*^9, 
   3.8421734678650503`*^9}, {3.842173552699793*^9, 3.842173569868168*^9}, {
   3.842173615776001*^9, 3.8421736189991093`*^9}, {3.8421736987904806`*^9, 
   3.8421736995552883`*^9}, {3.842175849418278*^9, 3.8421758609344273`*^9}, {
   3.8421759017727947`*^9, 3.8421759801319885`*^9}, {3.8421761670986996`*^9, 
   3.842176191662031*^9}, {3.8421763632498636`*^9, 3.8421764527735357`*^9}, {
   3.842253062461074*^9, 3.8422532157407985`*^9}, {3.8422533027726965`*^9, 
   3.8422534186083937`*^9}, {3.8422534645668592`*^9, 
   3.8422535518879137`*^9}, {3.8422536726269693`*^9, 3.8422536761696844`*^9}, 
   3.842253724843224*^9, {3.842253882858946*^9, 3.842253906452571*^9}, {
   3.8422539866854243`*^9, 3.8422539932735233`*^9}, {3.8422541217831984`*^9, 
   3.8422541272986207`*^9}, {3.8422541773803396`*^9, 
   3.8422541960328493`*^9}, {3.842254229890911*^9, 3.842254328769086*^9}, {
   3.8422544807648835`*^9, 3.8422545356482725`*^9}, {3.842254575282212*^9, 
   3.8422546221252565`*^9}, {3.8422546940901594`*^9, 
   3.8422548811562967`*^9}, {3.842254972914815*^9, 3.8422549968275824`*^9}, {
   3.8422550886866875`*^9, 3.842255122065675*^9}, {3.8422552795949388`*^9, 
   3.8422552812714453`*^9}, {3.842255628576033*^9, 3.842255650018148*^9}, {
   3.842256807902383*^9, 3.8422568089951396`*^9}, {3.842257341715528*^9, 
   3.842257347598197*^9}, {3.842318173609934*^9, 3.842318249829064*^9}, {
   3.842319148687772*^9, 3.8423191724398546`*^9}, {3.8423192166785192`*^9, 
   3.842319254650144*^9}, {3.8423207619345245`*^9, 3.8423207626377273`*^9}, {
   3.8423208478001018`*^9, 3.842320848417602*^9}, {3.8423209362949677`*^9, 
   3.8423209404742727`*^9}, {3.8423212043403287`*^9, 
   3.8423212113793974`*^9}, {3.842321350342098*^9, 3.8423213509600134`*^9}, {
   3.842325370223098*^9, 3.8423253717122374`*^9}, {3.8423254522323933`*^9, 
   3.8423254698680105`*^9}, {3.8423257505656185`*^9, 
   3.8423257536424046`*^9}, {3.8423258826311846`*^9, 3.842325890718664*^9}, {
   3.8423260286526256`*^9, 3.842326041089053*^9}, {3.842326993512946*^9, 
   3.842327033112856*^9}, {3.842327067794058*^9, 3.8423270784707165`*^9}, {
   3.8423271410192966`*^9, 3.842327147407697*^9}, {3.8423272793501368`*^9, 
   3.8423272888804407`*^9}, {3.842327626141543*^9, 3.8423276703758297`*^9}, {
   3.842327970161245*^9, 3.8423279747190104`*^9}, {3.8423281479126387`*^9, 
   3.8423281538458557`*^9}, {3.8423282966606784`*^9, 3.84232829697686*^9}, {
   3.8423283349897366`*^9, 3.842328335060913*^9}, {3.8423284375273933`*^9, 
   3.8423284449781218`*^9}, {3.8423285756443205`*^9, 
   3.8423285800551386`*^9}, {3.842340039015396*^9, 3.8423400413444686`*^9}, {
   3.842340289002364*^9, 3.842340400645722*^9}, {3.842340576472372*^9, 
   3.8423406098936543`*^9}, {3.8423407545471196`*^9, 
   3.8423407794247665`*^9}, {3.842340878146631*^9, 3.8423409077793956`*^9}, {
   3.842340998618863*^9, 3.8423410030740695`*^9}, {3.842341042751797*^9, 
   3.8423411190837374`*^9}, {3.8423411535627747`*^9, 3.842341158570405*^9}, {
   3.842341211086836*^9, 3.8423412148917665`*^9}, {3.8423587561684303`*^9, 
   3.8423588142858615`*^9}, 3.8423588456731453`*^9, {3.842358885511324*^9, 
   3.842358922154646*^9}, {3.8423610179309874`*^9, 3.8423611394640512`*^9}, {
   3.842361312743745*^9, 3.842361372372857*^9}, {3.8423614845737486`*^9, 
   3.8423615619245663`*^9}, {3.8423615926136665`*^9, 
   3.8423616309538455`*^9}, {3.842361684434007*^9, 3.8423617925939827`*^9}, {
   3.8423618467815304`*^9, 3.8423618739438934`*^9}, {3.842362076768884*^9, 
   3.8423620854993067`*^9}, {3.842362159499357*^9, 3.8423622209392767`*^9}, {
   3.8423626411565733`*^9, 3.8423626509306917`*^9}, {3.842423442256127*^9, 
   3.8424234503108644`*^9}, {3.842423531507678*^9, 3.8424235378864307`*^9}, {
   3.8424236377313995`*^9, 3.8424236384215045`*^9}, {3.842423687646355*^9, 
   3.8424236881162405`*^9}, {3.8424238692812843`*^9, 
   3.8424239022316556`*^9}, {3.8424243566657777`*^9, 
   3.8424243575769176`*^9}, {3.842424422267887*^9, 3.842424479397403*^9}, {
   3.842424549257391*^9, 3.8424245850375257`*^9}, {3.8424247535803175`*^9, 
   3.842424753874692*^9}, {3.8424247904956894`*^9, 3.8424248306240473`*^9}, {
   3.8424257658587947`*^9, 3.8424257667887073`*^9}, {3.8425991090973573`*^9, 
   3.8425991629187593`*^9}, {3.8425993670579176`*^9, 3.842599387036544*^9}, {
   3.8425994171466856`*^9, 3.842599442299409*^9}, {3.8429634278406096`*^9, 
   3.842963428087834*^9}, {3.8432075684554462`*^9, 3.8432075971676793`*^9}, {
   3.843207651205214*^9, 3.8432076657582817`*^9}, {3.8432243368330607`*^9, 
   3.8432244375881004`*^9}, {3.8432246157549458`*^9, 
   3.8432246365867186`*^9}, {3.843224688080207*^9, 3.843224703045343*^9}, 
   3.8432253159317236`*^9, {3.8432253796504197`*^9, 3.843225463809593*^9}, {
   3.843484062702808*^9, 3.8434840893811717`*^9}, {3.843528836963517*^9, 
   3.8435288998892903`*^9}, {3.84352953593779*^9, 3.8435295435383086`*^9}, {
   3.843529600945702*^9, 3.843529662853819*^9}, {3.8435297059617558`*^9, 
   3.84352973829368*^9}, {3.8435298298076587`*^9, 3.843529841973839*^9}, {
   3.843529946711575*^9, 3.8435299529138823`*^9}, {3.8435300416200113`*^9, 
   3.843530058874278*^9}, {3.843530619370723*^9, 3.843530625906266*^9}, {
   3.8435310159674883`*^9, 3.8435310426996093`*^9}, {3.8435312020663786`*^9, 
   3.8435312240470033`*^9}, {3.8435314122068043`*^9, 3.84353144117737*^9}, {
   3.8435319131305346`*^9, 3.843531990827236*^9}, {3.843532022058325*^9, 
   3.843532146298462*^9}, {3.8435321812599983`*^9, 3.8435321845272627`*^9}, {
   3.843532296679557*^9, 3.8435322994748864`*^9}, {3.8435323501640167`*^9, 
   3.843532424702179*^9}, {3.8435324634265423`*^9, 3.8435324674896812`*^9}, {
   3.843532509546459*^9, 3.8435325097089214`*^9}, {3.843532623184474*^9, 
   3.8435327182307034`*^9}, {3.8435327891123424`*^9, 3.843532848609228*^9}, {
   3.8435348673725405`*^9, 3.843534928290063*^9}, {3.843534976897526*^9, 
   3.8435350677175417`*^9}, {3.8435355671331525`*^9, 3.843535586473155*^9}, {
   3.843535632850792*^9, 3.8435356429536457`*^9}, {3.843535680836586*^9, 
   3.843535682413455*^9}, {3.843535844537957*^9, 3.843535865228611*^9}, {
   3.8435359029637547`*^9, 3.843536042663015*^9}, {3.8435360738103337`*^9, 
   3.84353607407164*^9}, 3.8435361235636854`*^9, {3.843536188974778*^9, 
   3.8435361892273703`*^9}, 3.843536258809802*^9, 3.8435364737720814`*^9, {
   3.843536746186615*^9, 3.843536848194646*^9}, {3.8435372272597065`*^9, 
   3.8435372355221767`*^9}, {3.8435372792713823`*^9, 
   3.8435373040575056`*^9}, {3.843539638975134*^9, 3.8435396538439436`*^9}, {
   3.8435396972999225`*^9, 3.8435397266188574`*^9}, {3.8435545302682467`*^9, 
   3.843554534141136*^9}, {3.8435545944781017`*^9, 3.8435545978063183`*^9}, {
   3.843554702688446*^9, 3.8435547097164383`*^9}, {3.8435547514301357`*^9, 
   3.8435547821514835`*^9}, {3.8435548810724683`*^9, 
   3.8435548827116466`*^9}, {3.8435549212785597`*^9, 3.843554942774934*^9}, {
   3.84355536309875*^9, 3.843555372836914*^9}, 3.843555407133706*^9, {
   3.843573866613598*^9, 3.8435738935820985`*^9}, {3.843573929788495*^9, 
   3.843573959926772*^9}, {3.8435740239510303`*^9, 3.8435740649187183`*^9}, {
   3.8435741011785784`*^9, 3.843574102074667*^9}, 3.8435741326743903`*^9, {
   3.8435741729987154`*^9, 3.8435743162021575`*^9}, {3.843574353053443*^9, 
   3.8435743542924614`*^9}, {3.8435746780371428`*^9, 
   3.8435746782077312`*^9}, {3.84357471995909*^9, 3.8435747596105814`*^9}, {
   3.843575196632473*^9, 3.8435752012540846`*^9}, {3.8435752393043995`*^9, 
   3.843575276868994*^9}, {3.843575347051406*^9, 3.8435754373540125`*^9}, {
   3.8435754839513817`*^9, 3.843575512977851*^9}, {3.843575871195263*^9, 
   3.8435758756363597`*^9}, {3.843575909155813*^9, 3.843575978091477*^9}, {
   3.8435760232926455`*^9, 3.843576037309128*^9}, {3.8435761108405347`*^9, 
   3.843576130335451*^9}, {3.843576213767423*^9, 3.843576225822197*^9}, {
   3.843576266614153*^9, 3.8435762693029633`*^9}, {3.843576374813919*^9, 
   3.843576391747617*^9}, {3.8435764902622986`*^9, 3.843576495285839*^9}, {
   3.8437388200764494`*^9, 3.843738820235938*^9}, 3.8437388706301208`*^9, {
   3.8437390642660875`*^9, 3.843739066820325*^9}, {3.8437391134989753`*^9, 
   3.8437391158159246`*^9}, {3.8437391541163607`*^9, 3.843739155915964*^9}, {
   3.8437392587063437`*^9, 3.843739289226596*^9}, {3.8437393460367165`*^9, 
   3.843739371741163*^9}, {3.8437394128361034`*^9, 3.8437394443862524`*^9}, {
   3.8437394791565623`*^9, 3.843739525779433*^9}, {3.844778282033863*^9, 
   3.8447783150817738`*^9}, {3.844778740395481*^9, 3.8447787408813305`*^9}, {
   3.844778782399601*^9, 3.8447788029436464`*^9}, {3.844778880165493*^9, 
   3.844778889436965*^9}, {3.8447789201811256`*^9, 3.8447789202970715`*^9}, {
   3.8447789550043488`*^9, 3.8447791060179396`*^9}, {3.8447792487955785`*^9, 
   3.84477930725315*^9}, {3.8447793417024746`*^9, 3.8447794950160227`*^9}, {
   3.844779535418374*^9, 3.8447795385589457`*^9}, {3.8447795830600147`*^9, 
   3.844779587705014*^9}, {3.8447796242119884`*^9, 3.844779685804003*^9}, {
   3.844826914283125*^9, 3.8448269169264975`*^9}, {3.8448393706715465`*^9, 
   3.8448393959065714`*^9}, {3.8448396253269644`*^9, 
   3.8448396253864965`*^9}, {3.844839668295573*^9, 3.84483968566471*^9}, {
   3.844939953593935*^9, 3.8449399623934193`*^9}, {3.84493999517966*^9, 
   3.844940018058483*^9}, {3.844940098162051*^9, 3.8449401572525578`*^9}, {
   3.8449402346587687`*^9, 3.8449403103131027`*^9}, {3.8449403446444855`*^9, 
   3.8449404034139185`*^9}, {3.8449404442850018`*^9, 
   3.8449404901373153`*^9}, {3.8449405234818077`*^9, 
   3.8449405241839075`*^9}, {3.8449405685235367`*^9, 
   3.8449406136881313`*^9}, {3.844940655259616*^9, 3.8449406639508753`*^9}, {
   3.8449407177199965`*^9, 3.84494078209155*^9}, {3.8449408788756247`*^9, 
   3.8449408841222067`*^9}, {3.8449409168355284`*^9, 3.844940957939741*^9}, {
   3.8449410065759783`*^9, 3.8449410071927595`*^9}, {3.844941049604642*^9, 
   3.844941053514358*^9}, {3.84494109272789*^9, 3.844941093059905*^9}, {
   3.844941210410658*^9, 3.8449412528486357`*^9}, {3.8449413069438868`*^9, 
   3.844941561118154*^9}, {3.8450956066227536`*^9, 3.845095627005597*^9}, {
   3.845095709413354*^9, 3.845095820048625*^9}, {3.845096082651744*^9, 
   3.8450960930125713`*^9}, {3.845297137638398*^9, 3.8452971638796825`*^9}, 
   3.845297194265729*^9, 3.8452972362909317`*^9, {3.8452972728616343`*^9, 
   3.845297324679348*^9}, {3.845297567800788*^9, 3.845297568888131*^9}, {
   3.8454407057303643`*^9, 3.845440727601009*^9}, {3.8454407851075344`*^9, 
   3.8454409295189576`*^9}, 3.8454409775879526`*^9, {3.8454410107922935`*^9, 
   3.8454410270973525`*^9}, {3.8454410748768196`*^9, 3.845441089101457*^9}, {
   3.8454411879982023`*^9, 3.845441212126584*^9}, {3.845441307299966*^9, 
   3.845441357110548*^9}, {3.8454414182931504`*^9, 3.8454414232605886`*^9}, {
   3.8454415004029217`*^9, 3.8454415142009535`*^9}, 3.8454416296198425`*^9, {
   3.8454416880465646`*^9, 3.8454417740222735`*^9}, {3.8454418339158387`*^9, 
   3.845441880307197*^9}, {3.845441941888921*^9, 3.8454419706891527`*^9}, {
   3.845442101815543*^9, 3.84544213590396*^9}, {3.845442224903678*^9, 
   3.845442230654585*^9}, 3.845442340498096*^9, {3.845442949847103*^9, 
   3.8454429562806306`*^9}, {3.8454429895544662`*^9, 3.845442999183863*^9}, {
   3.8454431016476765`*^9, 3.845443149805775*^9}, {3.8454432635608683`*^9, 
   3.845443264960938*^9}, {3.845443376131871*^9, 3.8454433771843376`*^9}, {
   3.845542774890256*^9, 3.845542782123452*^9}, {3.845543109539571*^9, 
   3.8455431303742867`*^9}, {3.845543262841667*^9, 3.8455432755397425`*^9}, {
   3.845543321326465*^9, 3.845543337966503*^9}, {3.845543370935729*^9, 
   3.8455434834570165`*^9}, {3.845543574778967*^9, 3.8455436097886887`*^9}, {
   3.8455436992066073`*^9, 3.8455436993694277`*^9}, {3.8455437887218733`*^9, 
   3.845543790146816*^9}, {3.8455441773571568`*^9, 3.845544179248911*^9}, {
   3.8455446385711784`*^9, 3.8455446399910917`*^9}, {3.845545038839695*^9, 
   3.8455450828120966`*^9}, {3.8455451170961685`*^9, 
   3.8455451391967964`*^9}, {3.845545446914462*^9, 3.8455454482717505`*^9}, {
   3.8456453863272505`*^9, 3.845645410050955*^9}, {3.8456454429414434`*^9, 
   3.845645455528639*^9}, {3.8456458134221673`*^9, 3.845645830093255*^9}, {
   3.8456458625398684`*^9, 3.845645895747679*^9}, {3.8456460462428894`*^9, 
   3.845646070061081*^9}, {3.845646183074642*^9, 3.8456461929761047`*^9}, {
   3.8456462999844713`*^9, 3.8456463529022884`*^9}, {3.84564648629184*^9, 
   3.845646553217786*^9}, {3.845646644262916*^9, 3.845646782791546*^9}, {
   3.845646922758149*^9, 3.8456469267949233`*^9}, {3.8456469872138486`*^9, 
   3.845647000779378*^9}, {3.845647254369603*^9, 3.8456472678071766`*^9}, 
   3.8456472998332305`*^9, {3.845647377797187*^9, 3.845647384305008*^9}, {
   3.845647490620719*^9, 3.8456475022445865`*^9}, {3.8456475428531823`*^9, 
   3.8456475536664114`*^9}, {3.845647685475125*^9, 3.845647710052414*^9}, {
   3.8456477459983487`*^9, 3.8456477530142984`*^9}, {3.8456479445918074`*^9, 
   3.8456479649420185`*^9}, 3.845648033088917*^9, {3.8456485948028517`*^9, 
   3.8456486829249477`*^9}, {3.8456487314555664`*^9, 
   3.8456487358715935`*^9}, {3.845648824450691*^9, 3.84564897690901*^9}, {
   3.845649213059657*^9, 3.84564921881375*^9}, {3.8456493136978984`*^9, 
   3.8456493141562357`*^9}, {3.8456493539407454`*^9, 
   3.8456493541039624`*^9}, {3.845649398049593*^9, 3.845649403948949*^9}, {
   3.845649717391286*^9, 3.8456497187573147`*^9}, 3.8456498569000683`*^9, {
   3.845650296930651*^9, 3.845650298256862*^9}, {3.8456539473783884`*^9, 
   3.8456539893187876`*^9}, {3.8460483186873665`*^9, 3.846048325595807*^9}, {
   3.846048385898264*^9, 3.8460486059836884`*^9}, {3.846048641664236*^9, 
   3.8460486856965933`*^9}, {3.8460487161362715`*^9, 
   3.8460487226858473`*^9}, {3.8460487985196342`*^9, 3.846048799481882*^9}, {
   3.8460488484728765`*^9, 3.8460488895797844`*^9}, {3.846048939629631*^9, 
   3.846048941251517*^9}, {3.84604897700358*^9, 3.8460490491456227`*^9}, {
   3.8460490971883774`*^9, 3.846049135912698*^9}, {3.8460492026105895`*^9, 
   3.8460492042329445`*^9}, {3.846049570404149*^9, 3.8460495714875765`*^9}, {
   3.846050001606944*^9, 3.8460500234012566`*^9}, {3.8460500611491117`*^9, 
   3.846050065323467*^9}, {3.846050110837335*^9, 3.8460501328161535`*^9}, {
   3.8460501722035356`*^9, 3.846050192547374*^9}, {3.846050231117566*^9, 
   3.846050232529442*^9}, {3.8460504263705873`*^9, 3.846050438640411*^9}, {
   3.8460804159611893`*^9, 3.8460804208327875`*^9}, {3.846080459388311*^9, 
   3.846080475820115*^9}, {3.8460805385401344`*^9, 3.846080540044999*^9}, 
   3.8460808809182796`*^9, {3.846305438865413*^9, 3.84630548101344*^9}, 
   3.8463057537227936`*^9, {3.84630608656527*^9, 3.8463061041660433`*^9}, {
   3.846306311132832*^9, 3.8463063744857397`*^9}, {3.8463064686370664`*^9, 
   3.8463065608082237`*^9}, {3.8463066137926397`*^9, 
   3.8463067030310717`*^9}, {3.846306789021234*^9, 3.846306867260295*^9}, {
   3.846306965917576*^9, 3.8463070191285143`*^9}, {3.8463071493291297`*^9, 
   3.8463071858820086`*^9}, {3.8463073297749567`*^9, 
   3.8463073303837605`*^9}, {3.846307993052404*^9, 3.8463080141272116`*^9}, 
   3.846314796747446*^9, 3.8463149078130255`*^9, {3.8463150156209497`*^9, 
   3.8463150174331017`*^9}, {3.8463152265378237`*^9, 3.8463152361927557`*^9}, 
   3.846315317572921*^9, {3.8463156296601434`*^9, 3.846315632102723*^9}, {
   3.8463156936828213`*^9, 3.8463156949834394`*^9}, {3.8463167481161213`*^9, 
   3.8463169066975894`*^9}, {3.8463171708429813`*^9, 3.8463171909712424`*^9}, 
   3.846317276981902*^9, {3.8463173124797735`*^9, 3.846317344056218*^9}, {
   3.8463174165493946`*^9, 3.8463174168663497`*^9}, {3.8463174547518544`*^9, 
   3.846317507355322*^9}, {3.8463176384674654`*^9, 3.84631764003662*^9}, {
   3.846317783676885*^9, 3.8463177848937087`*^9}, {3.8463822657480206`*^9, 
   3.8463823986403093`*^9}, {3.8464710966752715`*^9, 
   3.8464711077433724`*^9}, {3.846471143031253*^9, 3.8464712356532574`*^9}, {
   3.8465683140825815`*^9, 3.8465683779536233`*^9}, {3.8466525214580183`*^9, 
   3.846652528768527*^9}, {3.846934264064921*^9, 3.8469342653689184`*^9}, {
   3.847002130453084*^9, 3.8470021495680313`*^9}, {3.847002251816267*^9, 
   3.8470023345168753`*^9}, {3.8470023761924458`*^9, 
   3.8470023774850187`*^9}, {3.8470027162180414`*^9, 
   3.8470027215228863`*^9}, {3.8470028144799786`*^9, 3.8470028594853*^9}, {
   3.847002963424429*^9, 3.847002989361082*^9}, {3.847003117903135*^9, 
   3.8470031199546685`*^9}, 3.8470032390874915`*^9, {3.8470038946936116`*^9, 
   3.847003917816841*^9}, 3.847004074405794*^9, 3.847010249627451*^9, {
   3.847010292696309*^9, 3.8470103218456397`*^9}, 3.847010495044594*^9, {
   3.847251172372736*^9, 3.8472511968799963`*^9}, {3.847254206835058*^9, 
   3.84725422294845*^9}, {3.847256522642609*^9, 3.847256550594036*^9}, {
   3.8472566278850417`*^9, 3.84725667705359*^9}, {3.8472567833212833`*^9, 
   3.8472567982988057`*^9}, {3.8472569006374397`*^9, 3.847256971901335*^9}, 
   3.847257181755218*^9, {3.8472576364711633`*^9, 3.847257637495127*^9}, {
   3.847258354820553*^9, 3.8472584223360176`*^9}, {3.8472585673518133`*^9, 
   3.8472585794664555`*^9}, {3.8474379686397543`*^9, 3.847437993562561*^9}, {
   3.8474380763347335`*^9, 3.847438258698484*^9}, {3.8478651668895445`*^9, 
   3.8478651670584383`*^9}, {3.8478658473640327`*^9, 
   3.8478658583217783`*^9}, {3.8478659677522936`*^9, 
   3.8478659681839886`*^9}, {3.847866263092062*^9, 3.847866289268058*^9}, {
   3.8478664634982524`*^9, 3.8478664682861366`*^9}, {3.847866593978093*^9, 
   3.84786659658282*^9}, 3.847867036850292*^9, 3.847867221278735*^9, {
   3.848029849303088*^9, 3.848029856427731*^9}, {3.8480299131278095`*^9, 
   3.8480299201270504`*^9}, {3.8480300011896286`*^9, 3.848030056035195*^9}, {
   3.8480300901958694`*^9, 3.848030095495126*^9}, {3.8480303267899666`*^9, 
   3.8480303495170603`*^9}, {3.8480304114033585`*^9, 
   3.8480304236966076`*^9}, {3.848030972334573*^9, 3.84803098687657*^9}, {
   3.848031421893755*^9, 3.8480314259155807`*^9}, {3.8480316012101145`*^9, 
   3.848031627891626*^9}, {3.8480317894013853`*^9, 3.848031874177765*^9}, {
   3.8480320111854353`*^9, 3.848032022673051*^9}, {3.848032165047056*^9, 
   3.848032171075232*^9}, {3.8480325471666536`*^9, 3.848032553865841*^9}, {
   3.8480328693635426`*^9, 3.848032875182984*^9}, {3.8480330537250204`*^9, 
   3.8480330972648916`*^9}, {3.8480337800338*^9, 3.8480337823184414`*^9}, {
   3.8480341016392975`*^9, 3.848034103358391*^9}, {3.848037342664843*^9, 
   3.8480373878153553`*^9}, {3.8480374324859037`*^9, 
   3.8480374445903096`*^9}, {3.8480375146259007`*^9, 3.848037517624839*^9}, {
   3.848037628123928*^9, 3.8480376313877935`*^9}, {3.8480377453311863`*^9, 
   3.848037752849684*^9}, {3.848037807443531*^9, 3.848037808816365*^9}, {
   3.84803791485126*^9, 3.848037990981077*^9}, {3.8480381902625065`*^9, 
   3.8480382656388645`*^9}, {3.848038975201696*^9, 3.848038977175649*^9}, {
   3.8480393315865374`*^9, 3.8480393322411437`*^9}, {3.8480403818351135`*^9, 
   3.8480403955785418`*^9}, {3.8480404653372335`*^9, 3.848040512492178*^9}, {
   3.8480405610554485`*^9, 3.848040577812252*^9}, {3.848040660275632*^9, 
   3.8480407005651026`*^9}, {3.84804075801801*^9, 3.8480407637007465`*^9}, {
   3.848041447680271*^9, 3.848041488982892*^9}, {3.8480415389191885`*^9, 
   3.848041556944118*^9}, {3.848042058622718*^9, 3.8480420761541195`*^9}, 
   3.8480421376904755`*^9, {3.8480421689078445`*^9, 3.8480421765627365`*^9}, {
   3.8480422136083755`*^9, 3.8480422199018173`*^9}, {3.8480424353008003`*^9, 
   3.8480424780378656`*^9}, 3.8480443905621786`*^9, {3.8480534249678984`*^9, 
   3.848053434058268*^9}, {3.848053477670577*^9, 3.848053486268424*^9}, {
   3.8480535714258027`*^9, 3.8480535736405296`*^9}, {3.848053608654764*^9, 
   3.848053622912698*^9}, {3.8480542026420856`*^9, 3.848054212979062*^9}, {
   3.848054338003747*^9, 3.8480543466858587`*^9}, {3.8480549391994877`*^9, 
   3.848054946063905*^9}, {3.848059550234635*^9, 3.848059559628688*^9}, {
   3.848059606115282*^9, 3.848059648407256*^9}, {3.848059680855152*^9, 
   3.848059684207444*^9}, {3.8480597388364763`*^9, 3.848059745871933*^9}, {
   3.84805977853505*^9, 3.8480598004752626`*^9}, {3.84805985526337*^9, 
   3.848059876063639*^9}, 3.848059923475464*^9, {3.8480599701671886`*^9, 
   3.848060027034836*^9}, {3.848060693155694*^9, 3.8480607289527655`*^9}, {
   3.848063199287341*^9, 3.84806323630495*^9}, {3.848063276693512*^9, 
   3.848063354404126*^9}, {3.8480643112645535`*^9, 3.848064312884637*^9}, {
   3.848064473642066*^9, 3.8480644757016935`*^9}, {3.8481083095332594`*^9, 
   3.848108365012248*^9}, {3.848109181906223*^9, 3.848109187748026*^9}, {
   3.848110021902811*^9, 3.8481100278987427`*^9}, 3.8481101238146133`*^9, {
   3.848110154435714*^9, 3.848110167080419*^9}, {3.8481102374327345`*^9, 
   3.8481102507905664`*^9}, {3.848110445565012*^9, 3.848110447291093*^9}, {
   3.848111297443886*^9, 3.8481113586283507`*^9}, {3.848111870613484*^9, 
   3.8481118799450393`*^9}, {3.8481127105398293`*^9, 3.84811272158136*^9}, {
   3.8481128716452637`*^9, 3.84811287410082*^9}, {3.8481160360623913`*^9, 
   3.8481160376110363`*^9}, {3.8481189440373707`*^9, 3.848118954837912*^9}, {
   3.848119106185814*^9, 3.8481191100119963`*^9}, {3.848119307714133*^9, 
   3.848119308717033*^9}, {3.8481195748169284`*^9, 3.8481195793249035`*^9}, {
   3.8481199711457033`*^9, 3.84811997701952*^9}, {3.848120048850552*^9, 
   3.848120059310852*^9}, {3.8481202139040213`*^9, 3.84812022087764*^9}, {
   3.848120251706484*^9, 3.8481202590509214`*^9}, {3.8481205726716194`*^9, 
   3.848120606083742*^9}, {3.8481206717506423`*^9, 3.848120672087798*^9}, {
   3.8481207431183863`*^9, 3.8481207433721914`*^9}, {3.848120871959489*^9, 
   3.848120881064744*^9}, {3.84812150565821*^9, 3.848121524269825*^9}, 
   3.8483948159840775`*^9, 3.84839485904513*^9, {3.8485498453887177`*^9, 
   3.848549845742958*^9}, {3.8487164584824047`*^9, 3.848716463432952*^9}, {
   3.849160655626397*^9, 3.8491607584423246`*^9}, {3.84924162169585*^9, 
   3.8492416230304284`*^9}, {3.849883560629271*^9, 3.849883561200199*^9}, {
   3.850383241508747*^9, 3.850383355090252*^9}, {3.8503833884266567`*^9, 
   3.850383461009267*^9}, {3.8503835708432765`*^9, 3.850383589833471*^9}, {
   3.85038363807047*^9, 3.8503836431143537`*^9}, {3.8503837552507257`*^9, 
   3.8503838671475983`*^9}, {3.850383970513734*^9, 3.8503839953867006`*^9}, {
   3.850384037280059*^9, 3.8503840666225157`*^9}, {3.850384138960865*^9, 
   3.850384142077608*^9}, {3.8503841817308636`*^9, 3.850384198372345*^9}, {
   3.8557219778518515`*^9, 3.855721978397998*^9}, {3.855722038362727*^9, 
   3.855722247121235*^9}, {3.855722313998593*^9, 3.855722333118578*^9}, {
   3.8559834135153294`*^9, 3.8559834141058455`*^9}, {3.8696266053590803`*^9, 
   3.869626605503713*^9}, {3.8696266357547717`*^9, 3.869626654027177*^9}, {
   3.869626737306337*^9, 3.8696267943328123`*^9}, {3.869627677232877*^9, 
   3.8696277327998867`*^9}, 3.8696295705185504`*^9, {3.869630087106484*^9, 
   3.8696300997284503`*^9}, {3.8696304876186275`*^9, 3.869630488223092*^9}, 
   3.8727337035115013`*^9, {3.8780326414574804`*^9, 3.8780326418841753`*^9}, 
   3.878032711826194*^9, {3.879903853719318*^9, 3.8799038921473775`*^9}, {
   3.8846656981158123`*^9, 3.8846657023925285`*^9}, {3.884668122280821*^9, 
   3.8846681251182623`*^9}, {3.8859744720531445`*^9, 3.885974551487092*^9}, {
   3.885974808687544*^9, 3.8859750217374496`*^9}, {3.8859750536589785`*^9, 
   3.885975053794162*^9}, {3.8859751381362133`*^9, 3.8859751390282183`*^9}, {
   3.885975176982231*^9, 3.885975177685391*^9}, {3.8859752185158415`*^9, 
   3.8859752228473063`*^9}, {3.88597525721314*^9, 3.885975265591998*^9}, {
   3.88597556951223*^9, 3.885975570218977*^9}, {3.8859756105362864`*^9, 
   3.885975630494579*^9}, {3.885975669154857*^9, 3.8859756700529795`*^9}, {
   3.885976643636742*^9, 3.885976643788192*^9}, {3.885976680255766*^9, 
   3.885976680457446*^9}, {3.8859767143186445`*^9, 3.885976781259626*^9}, {
   3.8859768169280353`*^9, 3.8859768170719376`*^9}, {3.885976862055044*^9, 
   3.8859769059693727`*^9}, {3.88597709690452*^9, 3.8859771044030704`*^9}, {
   3.885977147725009*^9, 3.8859773661521363`*^9}, {3.8859775696353893`*^9, 
   3.8859775841917033`*^9}, {3.8859776599377284`*^9, 
   3.8859777200967946`*^9}, {3.8859777562144995`*^9, 3.885977829601741*^9}, {
   3.88597786063204*^9, 3.885977922153738*^9}, {3.8859779817008524`*^9, 
   3.8859779874504614`*^9}, {3.8859780186568203`*^9, 3.885978024533353*^9}, {
   3.8859796193557777`*^9, 3.8859796243310227`*^9}, {3.885979680471153*^9, 
   3.8859796821844807`*^9}, {3.8859797393789916`*^9, 
   3.8859797466625357`*^9}, {3.885979801081749*^9, 3.885979837249213*^9}, 
   3.885979868099738*^9, {3.8859799048509626`*^9, 3.885979929037464*^9}, {
   3.8859799690575686`*^9, 3.8859800111582003`*^9}, {3.8859800543471513`*^9, 
   3.885980101395406*^9}, {3.885980190581758*^9, 3.885980223558694*^9}, 
   3.8859804141829567`*^9, {3.8860485065215645`*^9, 3.886048544143625*^9}, {
   3.8860487232673163`*^9, 3.8860487368028064`*^9}, {3.8860488427193255`*^9, 
   3.8860488708576756`*^9}, {3.8860489155495424`*^9, 
   3.8860489706890693`*^9}, {3.8860490462956214`*^9, 3.88604905343861*^9}, {
   3.8860502848549786`*^9, 3.8860502852098074`*^9}, 3.8860506439066143`*^9, {
   3.886058643662526*^9, 3.886058898028778*^9}, {3.886058938453868*^9, 
   3.8860591965960336`*^9}, 3.886059235925458*^9, {3.8860594768468647`*^9, 
   3.886059583464303*^9}, {3.8860596969132223`*^9, 3.8860597272604127`*^9}, {
   3.8860597700895452`*^9, 3.886059782431409*^9}, {3.8860598134171524`*^9, 
   3.886059821774979*^9}, {3.886059885314715*^9, 3.8860601913246093`*^9}, {
   3.8860602263776765`*^9, 3.886060376005887*^9}, {3.8860604073548527`*^9, 
   3.886060636767073*^9}, {3.886060697313893*^9, 3.886060701340839*^9}, {
   3.886060739375802*^9, 3.886060758811112*^9}, {3.886060792482753*^9, 
   3.8860609272564273`*^9}, 3.886060959092801*^9, {3.886060989371854*^9, 
   3.8860610590294204`*^9}, {3.886062429712488*^9, 3.8860625596588926`*^9}, {
   3.886062772894846*^9, 3.886062773895776*^9}, {3.88606280923396*^9, 
   3.886062830446862*^9}, {3.8860628895571766`*^9, 3.8860629394048834`*^9}, 
   3.886218857800065*^9},ExpressionUUID->"c4ebcca8-c0f9-414e-b0db-\
2a96a8db1f6b"],

Cell[BoxData[{
 RowBox[{"Export", "[", 
  RowBox[{"\"\<sav.txt\>\"", ",", "savarray"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<total.txt\>\"", ",", "twtharray"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8846672386672225`*^9, 3.884667239717389*^9}, {
  3.884667353894706*^9, 3.8846673570898743`*^9}, {3.8846673941439233`*^9, 
  3.8846674416501555`*^9}, {3.8846689226874237`*^9, 3.884668923418905*^9}, {
  3.884669680139762*^9, 3.884669684007307*^9}, {3.885975144338399*^9, 
  3.8859751568842287`*^9}, {3.885975540135353*^9, 3.885975541042905*^9}, {
  3.886224306212884*^9, 
  3.886224307832326*^9}},ExpressionUUID->"0ab2cdad-767a-49cd-930a-\
dc00336526ca"]
},
Evaluator->"Kernel7",
WindowSize->{1920, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 486, 9, 86, "Input",ExpressionUUID->"570945a0-ea7e-4a61-879c-11b5e893f556"],
Cell[1047, 31, 8711, 184, 466, "Input",ExpressionUUID->"66edc94e-14f7-4175-b218-233bbc062f0a"],
Cell[9761, 217, 13299, 202, 181, "Input",ExpressionUUID->"e98b9b76-199a-4c9d-b3e2-0225b990dfc3"],
Cell[23063, 421, 11294, 252, 561, "Input",ExpressionUUID->"521cbb09-0da3-415f-8c45-b7a76a82b6f4"],
Cell[34360, 675, 1019, 23, 48, "Input",ExpressionUUID->"05efebbb-afdf-412e-a55e-a49053bac8af"],
Cell[35382, 700, 134102, 3083, 6071, "Input",ExpressionUUID->"c4ebcca8-c0f9-414e-b0db-2a96a8db1f6b"],
Cell[169487, 3785, 687, 12, 48, "Input",ExpressionUUID->"0ab2cdad-767a-49cd-930a-dc00336526ca"]
}
]
*)

